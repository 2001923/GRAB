library(GRAB)
library(GRAB)
library(GRAB)
print("aa");print("bb")
library(seqminer)
?SeqMiner
markers = c("A","b")
markers[1:10]
library(GRAB)
library(GRAB)
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
GenoFile
if(!file.exists(GenoFile))
stop(paste("Cannot find genotype file of", GenoFile))
GenoFileExt = tools::file_ext(GenoFile);
GenoFileExt
if(GenoFileExt != "bed")
stop("Current version only supports plink file input (file extension should be .bed).")  # support more genotype input later
GenoFileExt
GenoFileIndex = NULL
GenoFileIndex = c(gsub("bed$","bim",GenoFile),
gsub("bed$","fam",GenoFile))
GenoFileIndex
GeniFile
GenoFile
length(GenoFileIndex)
bimFile = GenoFileIndex[1]
famFile = GenoFileIndex[2]
sampleInfo = data.table::fread(famFile)
head(sampleInfo)
markerInfo = data.table::fread(bimFile)
head(markerInfo)
genoType
genoType = "PLINK"
# return genotype
print(paste("Based on the 'GenoFile', we set a genotype of", genoType, "format."))
setPLINKobjInR(bimFile, famFile, GenoFile, SampleInModel)
GRAB:::setPLINKobjInR()
library(GRAB)
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
readGeno(GenoFile)
library(GRAB)
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
readGeno(GenoFile)
library(GRAB)
GRAB::setPLINKobjInR()
library(GRAB)
library(GRAB)
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
readGeno(GenoFile)
library(GRAB)
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
GenoMat = readGeno(GenoFile)
dim(GenoMat)
head(GenoMat)
library(GRAB)
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
GenoMat = readGeno(GenoFile)
head(GenoMat)
library(GRAB)
?GRAB
?GRAB::readGeno
?readGeno
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
GenoMat = readGeno(GenoFile)
head(GenoMat)
##
PvalAnno = data.table::fread("Y:/POLMM-Gene/UKBB/2021-01-04-WES-200k-liking-anno/X20600-anno.txt")
PvalAnno = as.data.frame(PvalAnno)
colnames(PvalAnno)
PvalAnno$`P.SKAT-O`[1]
Annotation = unlist(strsplit(PvalAnno$`Annotation`[1], ","))
nPval = length(Annotation)
nGene = nrow(PvalAnno)
PvalMat = matrix(0, nGene, nPval)
rownames(PvalMat) = PvalAnno[,1];
colnames(PvalMat) = Annotation;
for(i in 1:nGene){
P.SKATO = as.numeric(unlist(strsplit(PvalAnno$`P.SKAT-O`[i],",")))
for(j in 1:nPval){
PvalMat[i,j] = P.SKATO[j]
}
}
head(PvalMat)
library(tidyr)
ExpectPvalMat = PvalMat
a=PvalMat$CADD_phred[1:6]
a=PvalMat[1:6,"CADD_phred"]
a
rank(a)
rank(a,na.last = "keep")
ExpectPvalMat = PvalMat
for(i in 1:ncol(PvalMat)){
ExpectPvalMat[,i] = rank(PvalMat[,i], na.last="keep")/length(!is.na(PvalMat[,i]))
}
head(PvalMat)
head(ExpectPvalMat)
head(PvalMat)
PvalMat.v1 = gather(PvalMat, "Annotation", "P-value", `All`:`NotSynonymousSNV`)
PvalMat = as.data.frame(PvalMat)
PvalMat.v1 = gather(PvalMat, "Annotation", "P-value", `All`:`NotSynonymousSNV`)
ExpectPvalMat = as.data.frame(ExpectPvalMat)
ExpectPvalMat.v1 = gather(ExpectPvalMat, "Annotation", "P-value", `All`:`NotSynonymousSNV`)
head(PvalMat.v1)
head(PvalMat)
PvalMat$Gene = rownames(PvalMat)
PvalMat.v1 = gather(PvalMat, "Annotation", "P-value", `All`:`NotSynonymousSNV`)
ExpectPvalMat.v1 = gather(ExpectPvalMat, "Annotation", "P-value", `All`:`NotSynonymousSNV`)
head(PvalMat.v1)
head(ExpectPvalMat.v1)
ExpectPvalMat$Gene = rownames(ExpectPvalMat)
ExpectPvalMat.v1 = gather(ExpectPvalMat, "Annotation", "P-value", `All`:`NotSynonymousSNV`)
head(PvalMat.v1)
head(ExpectPvalMat.v1)
PvalMat.v1 = gather(PvalMat, "Annotation", "true-P-value", `All`:`NotSynonymousSNV`)
ExpectPvalMat.v1 = gather(ExpectPvalMat, "Annotation", "expect-P-value", `All`:`NotSynonymousSNV`)
PvalMat.v1$`expect-P-value` = ExpectPvalMat.v1$`expect-P-value`
head(PvalMat.v1)
library(ggplot2)
ggplot(PvalMat.v1, aes(-log10(`expect-P-value`),-log10(`true-P-value`))) +
geno_point() + facet_wrap(~Annotation)
ggplot(PvalMat.v1, aes(-log10(`expect-P-value`),-log10(`true-P-value`))) +
geom_points() + facet_wrap(~Annotation)
ggplot(PvalMat.v1, aes(-log10(`expect-P-value`),-log10(`true-P-value`))) +
geom_point() + facet_wrap(~Annotation)
ggplot(PvalMat.v1, aes(-log10(`expect-P-value`),-log10(`true-P-value`))) +
geom_point() + facet_wrap(~Annotation) + geom_abline(slope=1,intercept=0,color="red")
p = ggplot(PvalMat.v1, aes(-log10(`expect-P-value`),-log10(`true-P-value`))) +
geom_point() + facet_wrap(~Annotation) + geom_abline(slope=1,intercept=0,color="red")
ggsave("Y:/POLMM-Gene/UKBB/2021-01-04-WES-200k-liking-anno/X20600-anno.jpeg", p, width=7, height=7)
dev.off()
library(GRAB)
?GRAB
?GRAB.Marker
library(GRAB)
library(GRAB)
library(GRAB)
library(GRAB)
library(GRAB)
library(GRAB)
library(GRAB)
library(GRAB)
library(GRAB)
library(GRAB)
library(GRAB)
library(GRAB)
library(GRAB)
library(GRAB)
library(GRAB)
library(GRAB)
library(GRAB)
library(GRAB)
library(GRAB)
library(GRAB)
library(GRAB)
library(GRAB)
library(GRAB)
library(GRAB)
