library(GRAB)
library(GRAB)
?GRAB::readGeno
library(devtools)  # author version: 2.3.0
install_github("GeneticAnalysisinBiobanks/GRAB")
?GRAB
?GRAB::GRAB.Marker
seq(1, 1000, 10)
seq(1, 1000, 1000)
splitMarker = function(markers, nMarkersEachChunk)
{
M = length(markers)
idxStart = seq(1, M, nMarkersEachChunk)
idxEnd = idxStart + nMarkersEachChunk - 1
nChunks = length(idxStart)
idxEnd[nChunks] = min(idxEnd[nChunks], M)
markerList = list()
for(i in 1:nChunks){
idxMarker = idxStart[i]:idxEnd[i]
markerList[[i]] = markers[idxMarker]
}
return(markerList)
}
splitMarker(1:10,2)
splitMarker(1:10, 3)
splitMarker(1:10, 10)
splitMarker(1:10, 11)
splitMarker = function(markers, nMarkersEachChunk)
{
M = length(markers)
idxStart = seq(1, M, nMarkersEachChunk)
idxEnd = idxStart + nMarkersEachChunk - 1
nChunks = length(idxStart)
idxEnd[nChunks] = M
markerList = list()
for(i in 1:nChunks){
idxMarker = idxStart[i]:idxEnd[i]
markerList[[i]] = markers[idxMarker]
}
return(markerList)
}
splitMarker(1:10, 2)
splitMarker(1:10, 3)
splitMarker(1:10, 10)
splitMarker(1:10, 11)
p=runif(1e6)
sum(p<1e-4)
library(GRAB)
?readGeno
?readGeno
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
GenoMat = readGeno(GenoFile)
GenoFile
dim(GenoMat)
head(GenoMat)
library(GRAB)
library(GRAB)
?GRAB::readGeno
library(GRAB)
?CCT
GRAB::CCT()
?GRAB::CCT
library(GRAB)
?GRAB::CCT
??CCT
library(GRAB)
library(GRAB)
library(GRAB)
library(GRAB)
library(GRAB)
library(GRAB)
?CCT
library(GRAB)
?CCT
pvalues <- c(2e-02,4e-04,0.2,0.1,0.8)
CCT(pvals=pvalues)
source('Y:/POLMM-Gene/UKBB/2021-01-04-WES-200k-liking-anno/CCT.R', echo=TRUE)
library(GRAB)
library(GRAB)
sigLevel = 2.5e-6
sigLevel
library(GRAB)
rm(list=ls())
library(SPACox)
SPACox.one.SNP
SPACox:::GetProb_SPA
SPACox::K2
SPACox:::K2
SPACox:::SPACox_Null_Model
?approxfun
x <- 1:10
y <- rnorm(10)
par(mfrow = c(2,1))
plot(x, y, main = "approx(.) and approxfun(.)")
points(approx(x, y), col = 2, pch = "*")
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
rm(list=ls())
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
.x
x
?approxfun
stats::approxfun
C_ApproxTest
.Call(C_ApproxTest)
a=runif(10)
b=rnorm(10)
fun1=approxfun(sort(a),b)
?uniroot
?approxfun
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
f=approxfunInCPP(x, y, a)
f(1)
f(2)
f(0.1)
f(0.4)
f(0.6)
x
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
?uniroot
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
?uniroot
f <- function (x, a) x - a
f(c(2,3,4),2)
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
x
y
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
findRoot(f)
?root
?uniroot
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
?approxfun
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
Rcpp::sourceCpp('C:/Users/wenji/Dropbox/software/check-load-R-Code.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
approxfun
xVec=1:10;yVec=rnorm(10);f=approxfun(xVec,yVec)
f
class(f)
View(f)
?approxfun
Rcpp::sourceCpp('src/approxfun.cpp')
Rcpp::sourceCpp('src/approxfun.cpp')
approxfun(2.5, 1:10, 1:10, 1, 10, 10)
approxfun(2.5, 1:10, 1:20, 1, 10, 10)
seq(1,10,0.5)
approxfun(2.5, seq(1,10,0.5), 1:19, 1, 19, 19)
seq(1,10,0.5)
approxfun(2.7, seq(1,10,0.5), 1:19, 1, 19, 19)
Rcpp::sourceCpp('src/temp.cpp')
Rcpp::sourceCpp('src/temp.cpp')
Rcpp::sourceCpp('src/temp.cpp')
mean(c(0.55391765,-0.06191171))
tempFun(2, xVec, yVec)
tempFun(3, xVec, yVec)
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
uniroot
Rcpp::sourceCpp('src/uniroot.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
help(SPACox::SPACox)
help(SPACox)
