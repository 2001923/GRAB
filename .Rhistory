event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
# Step 1: fit a null model
obj.SPACox = GRAB.NullModel(survival::Surv(time,event) ~ Cov1 + Cov2,
data = Pheno, subjData = Pheno$ID,
method = "SPACox", traitType = "time-to-event")
# Step 2: run score test
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/SPACoxMarkers.txt")
GRAB.Marker(obj.SPACox, GenoFile = GenoFile,
OutputFile = OutputFile)
Results = data.table::fread(OutputFile)
hist(Results$Pval)
library(GRAB)
fam.file = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.fam", package = "GRAB")
fam.data = read.table(fam.file)
set.seed(1)
N = 1000
Pheno = data.frame(ID = fam.data$V2,
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
# Step 1: fit a null model
obj.SPACox = GRAB.NullModel(survival::Surv(time,event) ~ Cov1 + Cov2,
data = Pheno, subjData = Pheno$ID,
method = "SPACox", traitType = "time-to-event")
# Step 2: run score test
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/SPACoxMarkers.txt")
GRAB.Marker(obj.SPACox, GenoFile = GenoFile,
OutputFile = OutputFile)
Results = data.table::fread(OutputFile)
hist(Results$Pval)
library(SPACox)
fam.file = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.fam", package = "GRAB")
fam.data = read.table(fam.file)
obj.null = SPACox_Null_Model(survival::Surv(time,event)~Cov1+Cov2, data=Pheno,
pIDs=Pheno$ID, gIDs=fam.data$V2)
## output is written in output.file
plink.file = gsub("-ext.fam","-ext",fam.file)
output.file = paste0(OutputDir, "/SPACoxMarkers1.txt")
SPACox.plink(obj.null, plink.file, output.file)
Results1 = data.table::fread(output.file)
SPACox.plink(obj.null, plink.file, output.file)
Results1 = data.table::fread(output.file)
head(Results1)
head(Results)
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
library(GRAB)
fam.file = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.fam", package = "GRAB")
fam.data = read.table(fam.file)
set.seed(1)
N = 1000
Pheno = data.frame(ID = fam.data$V2,
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
# Step 1: fit a null model
obj.SPACox = GRAB.NullModel(survival::Surv(time,event) ~ Cov1 + Cov2,
data = Pheno, subjData = Pheno$ID,
method = "SPACox", traitType = "time-to-event")
# Step 2: run score test
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/SPACoxMarkers.txt")
GRAB.Marker(obj.SPACox, GenoFile = GenoFile,
OutputFile = OutputFile)
Results = data.table::fread(OutputFile)
library(SPACox)
fam.file = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.fam", package = "GRAB")
fam.data = read.table(fam.file)
obj.null = SPACox_Null_Model(survival::Surv(time,event)~Cov1+Cov2, data=Pheno,
pIDs=Pheno$ID, gIDs=fam.data$V2)
## output is written in output.file
plink.file = gsub("-ext.fam","-ext",fam.file)
output.file = paste0(OutputDir, "/SPACoxMarkers1.txt")
SPACox.plink(obj.null, plink.file, output.file)
Results1 = data.table::fread(output.file)
head(Results)
head(Results1)
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
library(GRAB)
fam.file = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.fam", package = "GRAB")
fam.data = read.table(fam.file)
set.seed(1)
N = 1000
Pheno = data.frame(ID = fam.data$V2,
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
# Step 1: fit a null model
obj.SPACox = GRAB.NullModel(survival::Surv(time,event) ~ Cov1 + Cov2,
data = Pheno, subjData = Pheno$ID,
method = "SPACox", traitType = "time-to-event")
# Step 2: run score test
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/SPACoxMarkers.txt")
GRAB.Marker(obj.SPACox, GenoFile = GenoFile,
OutputFile = OutputFile)
Results = data.table::fread(OutputFile)
library(SPACox)
fam.file = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.fam", package = "GRAB")
fam.data = read.table(fam.file)
obj.null = SPACox_Null_Model(survival::Surv(time,event)~Cov1+Cov2, data=Pheno,
pIDs=Pheno$ID, gIDs=fam.data$V2)
## output is written in output.file
plink.file = gsub("-ext.fam","-ext",fam.file)
output.file = paste0(OutputDir, "/SPACoxMarkers1.txt")
SPACox.plink(obj.null, plink.file, output.file)
Results1 = data.table::fread(output.file)
head(Results)
head(Results1)
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(devtools)  # author version: 2.3.0
install_github("GeneticAnalysisinBiobanks/GRAB", INSTALL_opts=c("--no-multiarch"))
library(GRAB)
fam.file = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.fam", package = "GRAB")
fam.data = read.table(fam.file)
set.seed(1)
N = 1000
Pheno = data.frame(ID = fam.data$V2,
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
# Step 1: fit a null model
obj.SPACox = GRAB.NullModel(survival::Surv(time,event) ~ Cov1 + Cov2,
data = Pheno, subjData = Pheno$ID,
method = "SPACox", traitType = "time-to-event")
# Step 2: run score test
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/SPACoxMarkers.txt")
GRAB.Marker(obj.SPACox, GenoFile = GenoFile,
OutputFile = OutputFile)
Results = data.table::fread(OutputFile)
library(SPACox)
fam.file = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.fam", package = "GRAB")
fam.data = read.table(fam.file)
obj.null = SPACox_Null_Model(survival::Surv(time,event)~Cov1+Cov2, data=Pheno,
pIDs=Pheno$ID, gIDs=fam.data$V2)
## output is written in output.file
plink.file = gsub("-ext.fam","-ext",fam.file)
output.file = paste0(OutputDir, "/SPACoxMarkers1.txt")
SPACox.plink(obj.null, plink.file, output.file)
Results1 = data.table::fread(output.file)
head(Results)
head(Results1)
OutputDir
OutputDir = system.file("results", package = "GRAB")
OutputDir
library(GRAB)
fam.file = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.fam", package = "GRAB")
fam.file
library(GRAB)
library(GRAB)
fam.file = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.fam", package = "GRAB")
fam.data = read.table(fam.file)
set.seed(1)
N = 1000
Pheno = data.frame(ID = fam.data$V2,
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
# Step 1: fit a null model
obj.SPACox = GRAB.NullModel(survival::Surv(time,event) ~ Cov1 + Cov2,
data = Pheno, subjData = Pheno$ID,
method = "SPACox", traitType = "time-to-event")
# Step 2: run score test
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/SPACoxMarkers.txt")
GRAB.Marker(obj.SPACox, GenoFile = GenoFile,
OutputFile = OutputFile)
Results = data.table::fread(OutputFile)
library(SPACox)
fam.file = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.fam", package = "GRAB")
fam.data = read.table(fam.file)
obj.null = SPACox_Null_Model(survival::Surv(time,event)~Cov1+Cov2, data=Pheno,
pIDs=Pheno$ID, gIDs=fam.data$V2)
## output is written in output.file
plink.file = gsub("-ext.fam","-ext",fam.file)
output.file = paste0(OutputDir, "/SPACoxMarkers1.txt")
SPACox.plink(obj.null, plink.file, output.file)
Results1 = data.table::fread(output.file)
head(Results)
head(Results1)
obj.null$K_org_emp(1)
obj.null$K_org_emp(1)
obj.null$K_1_emp(1)
obj.null$K_2_emp(1)
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
library(GRAB)
fam.file = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.fam", package = "GRAB")
fam.data = read.table(fam.file)
set.seed(1)
N = 1000
Pheno = data.frame(ID = fam.data$V2,
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
# Step 1: fit a null model
obj.SPACox = GRAB.NullModel(survival::Surv(time,event) ~ Cov1 + Cov2,
data = Pheno, subjData = Pheno$ID,
method = "SPACox", traitType = "time-to-event")
# Step 2: run score test
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/SPACoxMarkers.txt")
GRAB.Marker(obj.SPACox, GenoFile = GenoFile,
OutputFile = OutputFile)
Results = data.table::fread(OutputFile)
library(SPACox)
fam.file = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.fam", package = "GRAB")
fam.data = read.table(fam.file)
obj.null = SPACox_Null_Model(survival::Surv(time,event)~Cov1+Cov2, data=Pheno,
pIDs=Pheno$ID, gIDs=fam.data$V2)
## output is written in output.file
plink.file = gsub("-ext.fam","-ext",fam.file)
output.file = paste0(OutputDir, "/SPACoxMarkers1.txt")
SPACox.plink(obj.null, plink.file, output.file)
Results1 = data.table::fread(output.file)
head(Results)
head(Results1)
obj.null$K_org_emp(1)
obj.null$K_1_emp(1)
obj.null$K_2_emp(1)
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
library(GRAB)
fam.file = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.fam", package = "GRAB")
fam.data = read.table(fam.file)
set.seed(1)
N = 1000
Pheno = data.frame(ID = fam.data$V2,
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
# Step 1: fit a null model
obj.SPACox = GRAB.NullModel(survival::Surv(time,event) ~ Cov1 + Cov2,
data = Pheno, subjData = Pheno$ID,
method = "SPACox", traitType = "time-to-event")
# Step 2: run score test
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/SPACoxMarkers.txt")
GRAB.Marker(obj.SPACox, GenoFile = GenoFile,
OutputFile = OutputFile)
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
library(GRAB)
fam.file = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.fam", package = "GRAB")
fam.data = read.table(fam.file)
set.seed(1)
N = 1000
Pheno = data.frame(ID = fam.data$V2,
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
# Step 1: fit a null model
obj.SPACox = GRAB.NullModel(survival::Surv(time,event) ~ Cov1 + Cov2,
data = Pheno, subjData = Pheno$ID,
method = "SPACox", traitType = "time-to-event")
# Step 2: run score test
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/SPACoxMarkers.txt")
GRAB.Marker(obj.SPACox, GenoFile = GenoFile,
OutputFile = OutputFile)
Results = data.table::fread(OutputFile)
head(Results)
library(SPACox)
fam.file = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.fam", package = "GRAB")
fam.data = read.table(fam.file)
obj.null = SPACox_Null_Model(survival::Surv(time,event)~Cov1+Cov2, data=Pheno,
pIDs=Pheno$ID, gIDs=fam.data$V2)
## output is written in output.file
plink.file = gsub("-ext.fam","-ext",fam.file)
output.file = paste0(OutputDir, "/SPACoxMarkers1.txt")
SPACox.plink(obj.null, plink.file, output.file)
Results1 = data.table::fread(output.file)
head(Results)
head(Results1)
which(Results1$p.value.spa < 0.01)
Results1[48,]
?GRAB.control
OutputDir
library(GRAB)
fam.file = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.fam", package = "GRAB")
fam.data = read.table(fam.file)
set.seed(1)
N = 1000
Pheno = data.frame(ID = fam.data$V2,
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
# Step 1: fit a null model
obj.SPACox = GRAB.NullModel(survival::Surv(time,event) ~ Cov1 + Cov2,
data = Pheno, subjData = Pheno$ID,
method = "SPACox", traitType = "time-to-event")
# Step 2: run score test
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/SPACoxMarkers.txt")
IDsToIncludeFile = paste0(OutputDir, "/IDsToIncludeFile.txt")
write.table(c("rs1276"), IDsToIncludeFile, row.names = F, col.names = F, quote = F)
GRAB.Marker(obj.SPACox, GenoFile = GenoFile,
OutputFile = OutputFile,
control = list(IDsToIncludeFile=IDsToIncludeFile))
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
library(GRAB)
fam.file = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.fam", package = "GRAB")
fam.data = read.table(fam.file)
set.seed(1)
N = 1000
Pheno = data.frame(ID = fam.data$V2,
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
# Step 1: fit a null model
obj.SPACox = GRAB.NullModel(survival::Surv(time,event) ~ Cov1 + Cov2,
data = Pheno, subjData = Pheno$ID,
method = "SPACox", traitType = "time-to-event")
# Step 2: run score test
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/SPACoxMarkers.txt")
IDsToIncludeFile = paste0(OutputDir, "/IDsToIncludeFile.txt")
write.table(c("rs1276"), IDsToIncludeFile, row.names = F, col.names = F, quote = F)
GRAB.Marker(obj.SPACox, GenoFile = GenoFile,
OutputFile = OutputFile,
control = list(IDsToIncludeFile=IDsToIncludeFile))
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
library(GRAB)
fam.file = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.fam", package = "GRAB")
fam.data = read.table(fam.file)
set.seed(1)
N = 1000
Pheno = data.frame(ID = fam.data$V2,
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
# Step 1: fit a null model
obj.SPACox = GRAB.NullModel(survival::Surv(time,event) ~ Cov1 + Cov2,
data = Pheno, subjData = Pheno$ID,
method = "SPACox", traitType = "time-to-event")
# Step 2: run score test
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/SPACoxMarkers.txt")
IDsToIncludeFile = paste0(OutputDir, "/IDsToIncludeFile.txt")
write.table(c("rs1276"), IDsToIncludeFile, row.names = F, col.names = F, quote = F)
GRAB.Marker(obj.SPACox, GenoFile = GenoFile,
OutputFile = OutputFile,
control = list(IDsToIncludeFile=IDsToIncludeFile))
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
library(GRAB)
fam.file = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.fam", package = "GRAB")
fam.data = read.table(fam.file)
set.seed(1)
N = 1000
Pheno = data.frame(ID = fam.data$V2,
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
# Step 1: fit a null model
obj.SPACox = GRAB.NullModel(survival::Surv(time,event) ~ Cov1 + Cov2,
data = Pheno, subjData = Pheno$ID,
method = "SPACox", traitType = "time-to-event")
# Step 2: run score test
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/SPACoxMarkers.txt")
IDsToIncludeFile = paste0(OutputDir, "/IDsToIncludeFile.txt")
write.table(c("rs1276"), IDsToIncludeFile, row.names = F, col.names = F, quote = F)
GRAB.Marker(obj.SPACox, GenoFile = GenoFile,
OutputFile = OutputFile,
control = list(IDsToIncludeFile=IDsToIncludeFile))
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
library(GRAB)
fam.file = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.fam", package = "GRAB")
fam.data = read.table(fam.file)
set.seed(1)
N = 1000
Pheno = data.frame(ID = fam.data$V2,
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
# Step 1: fit a null model
obj.SPACox = GRAB.NullModel(survival::Surv(time,event) ~ Cov1 + Cov2,
data = Pheno, subjData = Pheno$ID,
method = "SPACox", traitType = "time-to-event")
# Step 2: run score test
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/SPACoxMarkers.txt")
IDsToIncludeFile = paste0(OutputDir, "/IDsToIncludeFile.txt")
write.table(c("rs1276"), IDsToIncludeFile, row.names = F, col.names = F, quote = F)
GRAB.Marker(obj.SPACox, GenoFile = GenoFile,
OutputFile = OutputFile,
control = list(IDsToIncludeFile=IDsToIncludeFile))
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
library(GRAB)
fam.file = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.fam", package = "GRAB")
fam.data = read.table(fam.file)
set.seed(1)
N = 1000
Pheno = data.frame(ID = fam.data$V2,
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
# Step 1: fit a null model
obj.SPACox = GRAB.NullModel(survival::Surv(time,event) ~ Cov1 + Cov2,
data = Pheno, subjData = Pheno$ID,
method = "SPACox", traitType = "time-to-event")
# Step 2: run score test
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/SPACoxMarkers.txt")
IDsToIncludeFile = paste0(OutputDir, "/IDsToIncludeFile.txt")
write.table(c("rs1276"), IDsToIncludeFile, row.names = F, col.names = F, quote = F)
GRAB.Marker(obj.SPACox, GenoFile = GenoFile,
OutputFile = OutputFile,
control = list(IDsToIncludeFile=IDsToIncludeFile))
OutputFile
GRAB.Marker(obj.SPACox, GenoFile = GenoFile,
OutputFile = OutputFile)
# control = list(IDsToIncludeFile=IDsToIncludeFile))
Results = data.table::fread(OutputFile)
head(Results)
library(SPACox)
fam.file = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.fam", package = "GRAB")
fam.data = read.table(fam.file)
obj.null = SPACox_Null_Model(survival::Surv(time,event)~Cov1+Cov2, data=Pheno,
pIDs=Pheno$ID, gIDs=fam.data$V2)
## output is written in output.file
plink.file = gsub("-ext.fam","-ext",fam.file)
output.file = paste0(OutputDir, "/SPACoxMarkers1.txt")
SPACox.plink(obj.null, plink.file, output.file)
Results1 = data.table::fread(output.file)
head(Results)
head(Results1)
plot(Results$Pval, Results1$p.value.spa)
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
library(GRAB)
library(GRAB)
fam.file = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.fam", package = "GRAB")
fam.data = read.table(fam.file)
set.seed(1)
N = 1000
Pheno = data.frame(ID = fam.data$V2,
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
# Step 1: fit a null model
obj.SPACox = GRAB.NullModel(survival::Surv(time,event) ~ Cov1 + Cov2,
data = Pheno, subjData = Pheno$ID,
method = "SPACox", traitType = "time-to-event")
# Step 2: run score test
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/SPACoxMarkers.txt")
IDsToIncludeFile = paste0(OutputDir, "/IDsToIncludeFile.txt")
write.table(c("rs1276"), IDsToIncludeFile, row.names = F, col.names = F, quote = F)
GRAB.Marker(obj.SPACox, GenoFile = GenoFile,
OutputFile = OutputFile)
# control = list(IDsToIncludeFile=IDsToIncludeFile))
Results = data.table::fread(OutputFile)
head(Results)
library(SPACox)
fam.file = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.fam", package = "GRAB")
fam.data = read.table(fam.file)
obj.null = SPACox_Null_Model(survival::Surv(time,event)~Cov1+Cov2, data=Pheno,
pIDs=Pheno$ID, gIDs=fam.data$V2)
## output is written in output.file
plink.file = gsub("-ext.fam","-ext",fam.file)
output.file = paste0(OutputDir, "/SPACoxMarkers1.txt")
SPACox.plink(obj.null, plink.file, output.file)
Results1 = data.table::fread(output.file)
plot(Results$Pval, Results1$p.value.spa)
pos = which(Results1$p.value.norm < 0.02)
cbind(Results$Pval, Results1$p.value.spa)[pos,]
1.05287 ^ (1/2)
remove.packages("GRAB", lib="~/R/win-library/4.0")
