squares(c(1,2,3))
squares(1:1000)
library(GRAB)
library(GRAB)
a=squares(1:1000)
head(a)
library(GRAB)
a=squares(1:1000)
library(GRAB)
a=squares(1:1000)
library(GRAB)
?GRAB.ReadGeno
RawFile = system.file("extdata", "example.raw", package = "GRAB")
GenoMat = data.table::fread(RawFile)
head(GenoMat[,1:15])
PlinkFile = system.file("extdata", "example.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PlinkFile)
BGENFile = system.file("extdata", "example_bgen_1.2_8bits.bgen", package = "GRAB")
GenoList = GRAB.ReadGeno(BGENFile)
GenoMat = GenoList$GenoMat
markerInfo = GenoList$markerInfo
head(GenoMat)
?GRAB.ReadGeno
library(GRAB)
PlinkFile = system.file("extdata", "example.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PlinkFile)
library(GRAB)
library(GRAB)
?GRAB::GRAB.ReadGeno
PlinkFile = system.file("extdata", "example.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PlinkFile)
Rcpp::sourceCpp('C:/Users/wenji/OneDrive/Desktop/test_RcppMatch.cpp')
library(Rcpp)
Rcpp::sourceCpp('C:/Users/wenji/OneDrive/Desktop/test_RcppMatch.cpp')
sessionInfo()
Rcpp::sourceCpp('C:/Users/wenji/OneDrive/Desktop/test_RcppMatch.cpp')
sessionInfo()
Rcpp::sourceCpp('C:/Users/wenji/OneDrive/Desktop/test_RcppMatch.cpp')
library(GRAB)
Rcpp::sourceCpp('C:/Users/wenji/OneDrive/Desktop/test_RcppMatch.cpp')
library(GRAB)
?GRAB::GRAB.ReadGeno
PlinkFile = system.file("extdata", "example.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PlinkFile)
BGENFile = system.file("extdata", "example_bgen_1.2_8bits.bgen", package = "GRAB")
GenoList = GRAB.ReadGeno(BGENFile)
?data.table::fread
?file.exists
a = data.frame(a1=23,a2=34)
a
a[,]
data.frame(colnames(a)=NA)
system.time()
Sys.time()
i=1
nChunks=23
print(paste0("Analyzing Chunk ", i, "/", nChunks, " ......"))
print(paste0(Sys.time(),": Analyzing Chunk ", i, "/", nChunks, " ......"))
print(paste0("(",Sys.time(),") Analyzing Chunk ", i, "/", nChunks, " ......"))
print(paste0("(",Sys.time(),")    Analyzing Chunk ", i, "/", nChunks, " ......"))
print(paste0("(",Sys.time(),") --- Analyzing Chunk ", i, "/", nChunks, " ......"))
print(paste0("(",Sys.time(),") --- Analyzing Chunk ", i, "/", nChunks, " ---- "))
2361*6.5
4676*6.5
2000*6.5
source('Y:/WES-200k/2021-02-24-ukbb-traits/updateData/updateTrait.R')
length(31:97)
Rcpp::sourceCpp('C:/Users/wenji/OneDrive/Desktop/test_NA.cpp')
a=timesTwo(2)
is.na(a)
help(Startup)
R RHOME
readRenviron(path)
getwd()
read.table("~/.Renviron")
readRenviron("~/.Renviron")
data.table::fread("~/.Renviron")
Rcpp::sourceCpp('src/Main.cpp')
Rcpp::sourceCpp('src/Main.cpp')
Rcpp::sourceCpp('src/POLMM_Marker.cpp')
Rcpp::sourceCpp('src/POLMM_Marker.cpp')
Rcpp::sourceCpp('src/POLMM.cpp')
Rcpp::sourceCpp('src/POLMM.cpp')
Rcpp::sourceCpp('src/POLMM.cpp')
library(GRAB)
?GRAB.ReadGeno
RawFile = system.file("extdata", "example.raw", package = "GRAB")
GenoMat = data.table::fread(RawFile)
head(GenoMat[,1:15])
PlinkFile = system.file("extdata", "example.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PlinkFile)
GenoFile = PlinkFile
GenoFile
objGeno = GRAB:::setGenoInput(GenoFile, NULL, NULL)
head(objGeno$markerInfo)
library(GRAB)
?GRAB.ReadGeno
RawFile = system.file("extdata", "example.raw", package = "GRAB")
GenoMat = data.table::fread(RawFile)
head(GenoMat[,1:15])
## The below is for Plink format
PlinkFile = system.file("extdata", "example.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PlinkFile)
GenoMat = GenoList$GenoMat
markerInfo = GenoList$markerInfo
head(GenoMat)
BGENFile = system.file("extdata", "example_bgen_1.2_8bits.bgen", package = "GRAB")
GenoList = GRAB.ReadGeno(BGENFile)
GenoMat = GenoList$GenoMat
markerInfo = GenoList$markerInfo
head(GenoMat)
markerInfo
library(GRAB)
?GRAB.ReadGeno
RawFile = system.file("extdata", "example.raw", package = "GRAB")
GenoMat = data.table::fread(RawFile)
head(GenoMat[,1:15])
## The below is for Plink format
PlinkFile = system.file("extdata", "example.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PlinkFile)
GenoMat = GenoList$GenoMat
markerInfo = GenoList$markerInfo
head(GenoMat)
markerInfo
## The below is for BGEN format
BGENFile = system.file("extdata", "example_bgen_1.2_8bits.bgen", package = "GRAB")
GenoList = GRAB.ReadGeno(BGENFile)
GenoMat = GenoList$GenoMat
markerInfo = GenoList$markerInfo
head(GenoMat)
markerInfo
bgenFile = system.file("extdata", "example_bgen_1.2_8bits.bgen", package = "GRAB")
bgiFile = gsub("bgen$", "bgen.bgi", bgenFile)
db_con <- RSQLite::dbConnect(RSQLite::SQLite(), bgiFile)
on.exit(RSQLite::dbDisconnect(db_con), add = TRUE)
bgiData = dplyr::tbl(db_con, "Variant")
bgiData = as.data.frame(bgiData)
head(bgiData)
library(GRAB)
?GRAB.ReadGeno
RawFile = system.file("extdata", "example.raw", package = "GRAB")
GenoMat = data.table::fread(RawFile)
head(GenoMat[,1:15])
## The below is for Plink format
PlinkFile = system.file("extdata", "example.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PlinkFile)
GenoMat = GenoList$GenoMat
markerInfo = GenoList$markerInfo
head(GenoMat)
markerInfo
## The below is for BGEN format
BGENFile = system.file("extdata", "example_bgen_1.2_8bits.bgen", package = "GRAB")
GenoList = GRAB.ReadGeno(BGENFile)
GenoMat = GenoList$GenoMat
markerInfo = GenoList$markerInfo
head(GenoMat)
markerInfo
library(GRAB)
?getSampleIDsFromBGEN
BGENFile = system.file("extdata", "example_bgen_1.2_8bits.bgen", package = "GRAB")
a=getSampleIDsFromBGEN(BGENFile)
a
BGENFile
data.frame(GRAB_sample = a)
a1=data.frame(GRAB_sample = a)
head(a1)
a1=data.frame(GRAB_BGEN_Sample = a)
a1
head(a1)
BGENFile
write.table(a1, "C:/Users/wenji/OneDrive/Documents/R/win-library/4.0/GRAB/extdata/example_bgen_1.2_8bits.sample", row.names = F)
write.table(a1, "C:/Users/wenji/OneDrive/Documents/R/win-library/4.0/GRAB/extdata/example_bgen_1.2_8bits.sample", row.names = F, quote=FALS)
write.table(a1, "C:/Users/wenji/OneDrive/Documents/R/win-library/4.0/GRAB/extdata/example_bgen_1.2_8bits.sample", row.names = F, quote=FALSE)
toupper("GRAB_BGEN_Sample")
?GRAB.ReadGeno
write.table(a1, "C:/Users/wenji/OneDrive/Documents/R/win-library/4.0/GRAB/extdata/example_bgen_1.2_8bits.samples", row.names = F, quote=FALSE)
write.table(a1, "C:/Users/wenji/OneDrive/Documents/Github/GRAB/inst/extdata/example_bgen_1.2_8bits.samples", row.names = F, quote=FALSE)
?checkIfSampleIDsExist
library(GRAB)
?GRAB.ReadGeno
library(GRAB)
library(GRAB)
?GRAB.ReadGeno
system.file("extdata", "example_bgen_1.2_8bits.bgen.samples", package = "GRAB")
read.table(system.file("extdata", "example_bgen_1.2_8bits.bgen.samples", package = "GRAB)")
)
read.table(system.file("extdata", "example_bgen_1.2_8bits.bgen.samples", package = "GRAB)
read.table(system.file("extdata", "example_bgen_1.2_8bits.bgen.samples", package = "GRAB))
a=system.file("extdata", "example_bgen_1.2_8bits.bgen.samples", package = "GRAB)
a
a=system.file("extdata", "example_bgen_1.2_8bits.bgen.samples", package = "GRAB)"""
a=system.file("extdata", "example_bgen_1.2_8bits.bgen.samples", package = "GRAB")
a
read.table(a)
head(read.table(a))
head(read.table(a, col.names = T))
head(read.table(a, header = T))
?GRAB.ReadGeno
?checkIfSampleIDsExist
?GRAB.ReadGeno
topupper
toupper
library(GRAB)
?GRAB.ReadGeno
RawFile = system.file("extdata", "example.raw", package = "GRAB")
GenoMat = data.table::fread(RawFile)
head(GenoMat[,1:15])
## The below is for Plink format
PlinkFile = system.file("extdata", "example.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PlinkFile)
GenoMat = GenoList$GenoMat
markerInfo = GenoList$markerInfo
head(GenoMat)
markerInfo
BGENFile = system.file("extdata", "example_bgen_1.2_8bits.bgen", package = "GRAB")
GenoList = GRAB.ReadGeno(BGENFile)
GenoMat = GenoList$GenoMat
markerInfo = GenoList$markerInfo
head(GenoMat)
markerInfo
library(GRAB)
?GRAB.ReadGeno
library(GRAB)
library(GRAB)
?GRAB.ReadGeno
library(GRAB)
?GRAB.ReadGeno
library(GRAB)
?GRAB.control
?GRAB.SPACox
?GRAB.control
library(GRAB)
?GRAB.control
library(GRAB)
?GRAB.control
library(GRAB)
?GRAB.control
library(GRAB)
?GRAB.control
library(GRAB)
?getSparseGRMParallel
toupper("aa")
paste(c("aa","AA"))
paste(c("aa","AA"), collapse = T)
paste(c("aa","AA"), collapse = T)
?paste
paste(c("aa","AA"), collapse = ",")
library(GRAB)
?GRAB.Region
a=c("GRAB.outIndex", 1, 2)
getwd()
write.table(a, "Output.txt")
b=read.table("Output.txt")
b
write.table(a, "Output.txt", col.names = T)
b=read.table("Output.txt")
b
a
b
b[1]
b[1,1]
a
a
a=matrix(a, ncol = 1)
a
write.table(a, "Output.txt", row.names = F, col.names = F)
a
write.table(a, "Output.txt", row.names = F, col.names = F, quote=F)
b=read.table("Output.txt")
b
b[1]
b[1,1]
matrix(1,ncol=1)
matrix(2,ncol=1)
matrix(5,ncol=1)
Rcpp::sourceCpp('C:/Users/wenji/OneDrive/Desktop/test.cpp')
test(0,3)
test(1,3)
test(2,3)
test(3,3)
test(4,3)
Rcpp::sourceCpp('C:/Users/wenji/OneDrive/Desktop/test.cpp')
test(0,3)
test(1,3)
test(2,3)
test(3,3)
Rcpp::sourceCpp('C:/Users/wenji/OneDrive/Desktop/test.cpp')
Rcpp::sourceCpp('C:/Users/wenji/OneDrive/Desktop/test.cpp')
Rcpp::sourceCpp('C:/Users/wenji/OneDrive/Desktop/test.cpp')
Rcpp::sourceCpp('C:/Users/wenji/OneDrive/Desktop/test.cpp')
test(1)
test(1:56)
test()
test(NA)
4.8/3.3
a=4.8/3.3
390*a
350*a
500/a
?strsplit
data=1:10
data=data.frame(a=1:10)
data=data.frame(a=1:10,b=1:10)
ggplot(data, aes(a,b)) + geom_point()
library(ggplot2)
ggplot(data, aes(a,b)) + geom_point()
ggplot(data, aes(a,b)) + geom_point()+ggtitle("sfdfasdf")
ggplot(data, aes(a,b)) + geom_point()+ggtitle("sfdfasdfddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd")
ggplot(data, aes(a,b)) + geom_point()+ggtitle("sfdfasdfddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd  ddddddddddddd")
licence()
0.125/2
0.088 * 2
0.17582
0.175*2
library(GRAB)
?GRAB.ReadGeno
GenoFile = system.file("extdata", "example.bed", package = "GRAB")
GenoFileIndex = NULL
SampleIDs = NULL
control = NULL
GRAB:::checkControl.ReadGeno(control)  # this function is in 'control.R': indexGeno can be 0, 1, 2, 3, 4 depending on which argument is given.
objGeno = setGenoInput(GenoFile, GenoFileIndex, SampleIDs, control)
names(objGeno)
objGeno$genoType
objGeno$anyExclude
objGeno$anyInclude
objGeno$markersInclude
objGeno$markersExclude
objGeno$SampleIDs
names(objGeno)
dim(objGeno$markerInfo)
head(objGeno$markerInfo)
names(objGeno)
T | T
T | F
F | F
library(GRAB)
?GRAB.ReadGeno
RawFile = system.file("extdata", "example.raw", package = "GRAB")
GenoMat = data.table::fread(RawFile)
head(GenoMat[,1:15])
PlinkFile = system.file("extdata", "example.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PlinkFile)
GenoMat = GenoList$GenoMat
markerInfo = GenoList$markerInfo
head(GenoMat)
markerInfo
IDsToInclude = markerInfo$ID
IDsToInclude
IDsToInclude = matrix(markerInfo$ID, ncol=1)
IDsToInclude
system.file("extdata", "example.bed", package = "GRAB"
)
?GRAB.control
IDsToInclude = matrix(markerInfo$ID, ncol=1)
setwd("C:/Users/wenji/OneDrive/Documents/R/win-library/4.0/GRAB/extdata")
write.table(IDsToInclude,
"example.IDsToIncludeFile.txt",
quote = F, row.names = F, col.names = F)
setwd("C:/Users/wenji/OneDrive/Documents/Github/GRAB/inst/extdata")
write.table(IDsToInclude,
"example.IDsToIncludeFile.txt",
quote = F, row.names = F, col.names = F)
RangesToInclude = rbind(c(1,1,100),
c(2,1,100),
c(3,1,100))
RangesToInclude
write.table(RangesToInclude,
"example.RangesToIncludeFile.txt",
quote = F, row.names = F, col.names = F)
library(GRAB)
?GRAB.ReadGeno
IDsToIncludeFile = system.file("extdata", "example.IDsToIncludeFile.txt", package = "GRAB")
RangesToIncludeFile = system.file("extdata", "example.RangesToIncludeFile.txt", package = "GRAB")
IDsToIncludeFile
GenoList = GRAB.ReadGeno(PlinkFile, control = list(IDsToIncludeFile = IDsToIncludeFile, RangesToIncludeFile = RangesToIncludeFile))
IDsToIncludeFile
file.exists(IDsToIncludeFile)
library(GRAB)
?GRAB.ReadGeno
IDsToIncludeFile = system.file("extdata", "example.IDsToIncludeFile.txt", package = "GRAB")
RangesToIncludeFile = system.file("extdata", "example.RangesToIncludeFile.txt", package = "GRAB")
GenoList = GRAB.ReadGeno(PlinkFile,
control = list(IDsToIncludeFile = IDsToIncludeFile,
RangesToIncludeFile = RangesToIncludeFile))
file.exists("C:/Users/wenji/OneDrive/Documents/R/win-library/3.6/GRAB/extdata/example.bed")
PlinkFile
PlinkFile = system.file("extdata", "example.bed", package = "GRAB")
PlinkFile
IDsToIncludeFile = system.file("extdata", "example.IDsToIncludeFile.txt", package = "GRAB")
RangesToIncludeFile = system.file("extdata", "example.RangesToIncludeFile.txt", package = "GRAB")
GenoList = GRAB.ReadGeno(PlinkFile,
control = list(IDsToIncludeFile = IDsToIncludeFile,
RangesToIncludeFile = RangesToIncludeFile))
library(GRAB)
?GRAB.ReadGeno
PlinkFile = system.file("extdata", "example.bed", package = "GRAB")
IDsToIncludeFile = system.file("extdata", "example.IDsToIncludeFile.txt", package = "GRAB")
RangesToIncludeFile = system.file("extdata", "example.RangesToIncludeFile.txt", package = "GRAB")
GenoList = GRAB.ReadGeno(PlinkFile,
control = list(IDsToIncludeFile = IDsToIncludeFile,
RangesToIncludeFile = RangesToIncludeFile))
GenoMat = GenoList$GenoMat
markerInfo = GenoList$markerInfo
markerInfo
dim(GenoMat)
head(GenoMat)
GenoList = GRAB.ReadGeno(PlinkFile,
control = list(IDsToIncludeFile = IDsToIncludeFile,
RangesToExcludeFile = RangesToIncludeFile))
GenoList = GRAB.ReadGeno(PlinkFile,
control = list(IDsToExcludeFile = IDsToIncludeFile,
RangesToExcludeFile = RangesToIncludeFile))
GenoMat = GenoList$GenoMat
markerInfo = GenoList$markerInfo
dim(markerInfo)
?GRAB.control
library(GRAB)
?GRAB.ReadGeno
PlinkFile = system.file("extdata", "example.bed", package = "GRAB")
IDsToIncludeFile = system.file("extdata", "example.IDsToIncludeFile.txt", package = "GRAB")
RangesToIncludeFile = system.file("extdata", "example.RangesToIncludeFile.txt", package = "GRAB")
GenoList = GRAB.ReadGeno(PlinkFile,
control = list(IDsToIncludeFile = IDsToIncludeFile,
RangesToIncludeFile = RangesToIncludeFile,
AlleleOrder = "ref-first"))
GenoMat = GenoList$GenoMat
head(GenoMat)
markerInfo = GenoList$markerInfo
markerInfo
library(GRAB)
?GRAB.control
library(GRAB)
?GRAB.ReadGeno
RawFile = system.file("extdata", "example.raw", package = "GRAB")
GenoMat = data.table::fread(RawFile)
head(GenoMat[,1:15])
PlinkFile = system.file("extdata", "example.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PlinkFile)
GenoMat = GenoList$GenoMat
markerInfo = GenoList$markerInfo
head(GenoMat)
markerInfo
PlinkFile = system.file("extdata", "example.bed", package = "GRAB")
IDsToIncludeFile = system.file("extdata", "example.IDsToIncludeFile.txt", package = "GRAB")
RangesToIncludeFile = system.file("extdata", "example.RangesToIncludeFile.txt", package = "GRAB")
GenoList = GRAB.ReadGeno(PlinkFile,
control = list(IDsToIncludeFile = IDsToIncludeFile,
RangesToIncludeFile = RangesToIncludeFile,
AlleleOrder = "ref-first"))
GenoMat = GenoList$GenoMat
head(GenoMat)
markerInfo = GenoList$markerInfo
markerInfo
library(GRAB)
?GRAB.ReadGeno
RawFile = system.file("extdata", "example.raw", package = "GRAB")
GenoMat = data.table::fread(RawFile)
head(GenoMat[,1:15])
## The below is for Plink format
PlinkFile = system.file("extdata", "example.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PlinkFile)
GenoMat = GenoList$GenoMat
markerInfo = GenoList$markerInfo
head(GenoMat)
markerInfo
## The below is for BGEN format
BGENFile = system.file("extdata", "example_bgen_1.2_8bits.bgen", package = "GRAB")
GenoList = GRAB.ReadGeno(BGENFile)
GenoMat = GenoList$GenoMat
markerInfo = GenoList$markerInfo
head(GenoMat)
markerInfo
library(GRAB)
?GRAB.ReadGeno
RawFile = system.file("extdata", "example.raw", package = "GRAB")
GenoMat = data.table::fread(RawFile)
head(GenoMat[,1:15])
## The below is for Plink format
PlinkFile = system.file("extdata", "example.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PlinkFile)
GenoMat = GenoList$GenoMat
markerInfo = GenoList$markerInfo
head(GenoMat)
markerInfo
## The below is for BGEN format (Note the different REF/ALT order for BGEN and Plink formats)
BGENFile = system.file("extdata", "example_bgen_1.2_8bits.bgen", package = "GRAB")
GenoList = GRAB.ReadGeno(BGENFile)
GenoMat = GenoList$GenoMat
markerInfo = GenoList$markerInfo
head(GenoMat)
markerInfo
library(GRAB)
?GRAB.ReadGeno
RawFile = system.file("extdata", "example.raw", package = "GRAB")
GenoMat = data.table::fread(RawFile)
head(GenoMat[,1:15])
## The below is for Plink format
PlinkFile = system.file("extdata", "example.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PlinkFile)
GenoMat = GenoList$GenoMat
markerInfo = GenoList$markerInfo
head(GenoMat)
markerInfo
## The below is for BGEN format (Note the different REF/ALT order for BGEN and Plink formats)
BGENFile = system.file("extdata", "example_bgen_1.2_8bits.bgen", package = "GRAB")
GenoList = GRAB.ReadGeno(BGENFile)
GenoMat = GenoList$GenoMat
markerInfo = GenoList$markerInfo
head(GenoMat)
markerInfo
?GRAB.control
