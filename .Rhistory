BP=NULL
m=10
ifelse(is.null(BP), 1:m, BP)
is.null(BP)
1:m
mCHRs=TRUE
ifelse(mCHRs, sample(1:22, m, replace=T)
ï¼‰
ifelse(mCHRs, sample(1:22, m, replace=T), 1)
m
sample(1:22, m, replace=T)
?ifelse
ifelse(TRUE, 1,0)
ifelse(TRUE, c(1,2), 0)
ifelse(FALSE, c(1,2), c(0,0))
?GRAB.ReadGeno
PLINKFile = system.file("extdata", "simuPLINK.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE))
head(GenoList$GenoMat)
PLINKFile = system.file("extdata", "simuPLINK.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE, ImputeMethod = "mean"))
head(GenoList$GenoMat)
library(GRAB)
?GRAB.ReadGeno
PLINKFile = system.file("extdata", "simuPLINK.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE))
head(GenoList$GenoMat)
library(GRAB)
?GRAB.ReadGeno
PLINKFile = system.file("extdata", "simuPLINK.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE))
head(GenoList$GenoMat)
PLINKFile = system.file("extdata", "simuPLINK.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE, sparse = TRUE))
head(GenoList$GenoMat)
PLINKFile = system.file("extdata", "simuPLINK.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE), sparse = TRUE)
head(GenoList$GenoMat)
library(GRAB)
?GRAB.ReadGeno
PLINKFile = system.file("extdata", "simuPLINK.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE))
head(GenoList$GenoMat)
library(GRAB)
?GRAB.ReadGeno
PLINKFile = system.file("extdata", "simuPLINK.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE))
head(GenoList$GenoMat)
PLINKFile = system.file("extdata", "simuPLINK.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE, ImputeMethod = "s"))
head(GenoList$GenoMat)
PLINKFile = system.file("extdata", "simuPLINK.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE, ImputeMethod = "mean"))
head(GenoList$GenoMat)
PLINKFile = system.file("extdata", "simuPLINK.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE, ImputeMethod = "bestguess"))
head(GenoList$GenoMat)
library(GRAB)
?GRAB.ReadGeno
PLINKFile = system.file("extdata", "simuPLINK.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE))
head(GenoList$GenoMat)
library(GRAB)
?GRAB.ReadGeno
PLINKFile = system.file("extdata", "simuPLINK.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE))
head(GenoList$GenoMat)
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE, ImputeMethod = "mean"))
library(GRAB)
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE, ImputeMethod = "mean"))
head(GenoList$GenoMat)
PLINKFile
PLINKFile = system.file("extdata", "simuPLINK.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE, ImputeMethod = "mean"))
head(GenoList$GenoMat)
library(GRAB)
?GRAB.ReadGeno
BGENFile = system.file("extdata", "simuPLINK.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE))
head(GenoList$GenoMat)
BGENFile
BGENFile = system.file("extdata", "simuPLINK.bgen", package = "GRAB")
GenoList = GRAB.ReadGeno(BGENFile, control = list(AllMarkers = TRUE))
BGENFile
BGENFile = system.file("extdata", "simuPLINK.bgen", package = "GRAB")
BGENFile
system.file("extdata", package="GRAB")
BGENFile = system.file("extdata", "simuBGEN.bgen", package = "GRAB")
BGENFile
GenoList = GRAB.ReadGeno(BGENFile, control = list(AllMarkers = TRUE))
library(GRAB)
?GRAB.ReadGeno
BGENFile = system.file("extdata", "simuBGEN.bgen", package = "GRAB")
GenoList = GRAB.ReadGeno(BGENFile, control = list(AllMarkers = TRUE))
head(GenoList$GenoMat)
PLINKFile = system.file("extdata", "simuPLINK.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE))
head(GenoList$GenoMat)
GenoList$markerInfo
BGENFile = system.file("extdata", "simuBGEN.bgen", package = "GRAB")
GenoList = GRAB.ReadGeno(BGENFile, control = list(AllMarkers = TRUE))
head(GenoList$GenoMat)
GenoList$markerInfo
library(GRAB)
?GRAB.ReadGeno
PLINKFile = system.file("extdata", "simuPLINK.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE))
head(GenoList$GenoMat)
BGENFile = system.file("extdata", "simuBGEN.bgen", package = "GRAB")
GenoList = GRAB.ReadGeno(BGENFile, control = list(AllMarkers = TRUE))
head(GenoList$GenoMat)
getVersionFromBGEN(BGENFile)
?getVersionFromBGEN
?GRAB.ReadGeno
library(GRAB)
?GRAB.ReadGeno
PLINKFile = system.file("extdata", "simuPLINK.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE))
head(GenoList$GenoMat)
BGENFile = system.file("extdata", "simuBGEN.bgen", package = "GRAB")
GenoList = GRAB.ReadGeno(BGENFile, control = list(AllMarkers = TRUE))
head(GenoList$GenoMat)
library(GRAB)
?GRAB.ReadGeno
PLINKFile = system.file("extdata", "simuPLINK.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE))
head(GenoList$GenoMat)
BGENFile = system.file("extdata", "simuBGEN.bgen", package = "GRAB")
GenoList = GRAB.ReadGeno(BGENFile, control = list(AllMarkers = TRUE))
head(GenoList$GenoMat)
PLINKFile = system.file("extdata", "simuPLINK.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE, ImputeMethod = "mean"))
head(GenoList$GenoMat)
BGENFile = system.file("extdata", "simuBGEN.bgen", package = "GRAB")
GenoList = GRAB.ReadGeno(BGENFile, control = list(AllMarkers = TRUE, ImputeMethod = "mean"))
head(GenoList$GenoMat)
library(GRAB)
?GRAB.ReadGeno
PLINKFile = system.file("extdata", "simuPLINK.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE))
head(GenoList$GenoMat)
BGENFile = system.file("extdata", "simuBGEN.bgen", package = "GRAB")
GenoList = GRAB.ReadGeno(BGENFile, control = list(AllMarkers = TRUE))
head(GenoList$GenoMat)
\code{system.file("extdata", "simuBGEN.sample", package = "GRAB")
system.file("extdata", "simuBGEN.sample", package = "GRAB")
data.table::fread("C:/Users/wenjianb/Documents/R/win-library/4.1/GRAB/extdata/simuBGEN.sample")
colnames(sampleData)[1:4] != c("ID_1", "ID_2", "missing", "sex")
sampleData = data.table::fread("C:/Users/wenjianb/Documents/R/win-library/4.1/GRAB/extdata/simuBGEN.sample", header=T, sep = " ")
head(sampleData)
colnames(sampleData)[1:4] != c("ID_1", "ID_2", "missing", "sex")
sampleData[1,1:4] != c(0,0,0,"D")
any(colnames(sampleData)[1:4] != c("ID_1", "ID_2", "missing", "sex")) | any(sampleData[1,1:4] != c(0,0,0,"D"))
as.character(sampleData$ID_2[-1])
library(GRAB)
?GRAB.ReadGeno
library(GRAB)
?GRAB.ReadGeno
PLINKFile = system.file("extdata", "simuPLINK.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE))
head(GenoList$GenoMat)
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE, ImputeMethod = "mean"))
head(GenoList$GenoMat)
BGENFile = system.file("extdata", "simuBGEN.bgen", package = "GRAB")
GenoList = GRAB.ReadGeno(BGENFile, control = list(AllMarkers = TRUE))
head(GenoList$GenoMat)
library(GRAB)
?plink.make
n = 1000
m = 20
MAF = 0.3
Geno.mat = matrix(rbinom(n*m, 2, MAF), n, m)
rownames(Geno.mat) = paste0("Subj-",1:n)
colnames(Geno.mat) = paste0("SNP-",1:m)
indexMissing = sample(n*m, 0.1*n*m)
Geno.mat[indexMissing] = -9
work.dir = system.file("results", package = "GRAB")
out.prefix = "simuPLINK"
mCHRs = FALSE   # if FALSE, chromosomes of all markers are 1
BP = NULL
plink.make(Geno.mat, work.dir, out.prefix, mCHRs, BP)
data.table::fread("C:/Users/wenjianb/Documents/R/win-library/4.1/GRAB/results/simuPLINK.ped")
data.table::fread("C:/Users/wenjianb/Documents/R/win-library/4.1/GRAB/results/simuPLINK.bim")
data.table::fread("C:/Users/wenjianb/Documents/R/win-library/4.1/GRAB/results/simuPLINK.map")
?GRAB.ReadGeno
library(GRAB)
?GRAB.ReadGeno
PLINKFile = system.file("extdata", "simuPLINK.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE))
head(GenoList$GenoMat)
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE, ImputeMethod = "mean"))
head(GenoList$GenoMat)
BGENFile = system.file("extdata", "simuBGEN.bgen", package = "GRAB")
GenoList = GRAB.ReadGeno(BGENFile, control = list(AllMarkers = TRUE))
head(GenoList$GenoMat)
GenoList$markerInfo
?GRAB.NullModel
60319 / 0.95
751630.45 * 1.13
60319.5 * 1.13
60319.5 * 1.13
1800 / 68161
(73300 - 68161) / 68161
69608 / 0.95
qnorm(c(0.05))
qnorm(0)
qnorm(0.025)
?GRAB.ReadGeno
library(GRAB)
?GRAB.Region
?GRAB.ReadGeno
?GRAB.NullModel
?GRAB.NullModel
?GRAB.ReadGeno
library(SKAT)
?SKAT_Null_Model
?GRAB.NullModel
?SKAT_Null_Model
?GRAB.NullModel
?model.frame
?GRAB.NullModel
?model.frame
?model.frame
library(GRAB)
?GRAB.NullModel
?model.frame
?GRAB.NullModel
?model.frame
library(GRAB)
?GRAB.NullModel
?.data.frame
?[.data.frame)
?GRAB.NullModel
?data.frame
?model.frame
?data.frame
?data.frame
?model.frame
?subset
?GRAB.POLMM
?GRAB.NullModel
?GRAB.ReadGeno
library(GRAB)
?GRAB.NullModel
library(GRAB)
?GRAB.NullModel
?save
?GRAB.NullModel
?GRAB.POLMM
?GRAB.control
?glm
library(GRAB)
?GRAB.NullModel
?GRAB.POLMM
?GRAB.NullModel
?glm
?GRAB.NullModel
library(GRAB)
?GRAB.NullModel
library(GRAB)
?GRAB.ReadGeno
?GRAB.NullModel
?GRAB::getSparseGRM
library(GRAB)
?GRAB.NullModel
?GRM
?getSparseGRM
?getSparseGRM
?getSparseGRM
help(getSparseGRM)
\code{system.file("SparseGRM","SparseGRM.txt",package="GRAB")}
system.file("SparseGRM","SparseGRM.txt",package="GRAB")
data.table::fread("C:/Users/wenjianb/Documents/R/win-library/4.1/GRAB/SparseGRM/SparseGRM.txt")
PlinkFile = "sdfsd.bdsdf.bed"
basename(PlinkFile)
system.file("SparseGRM", "temp", package = "GRAB")
library(GRAB)
?getSparseGRM
?GRAB.NullModel
?getSparseGRM
?getTempFilesFullGRM
library(GRAB)
?getTempFilesFullGRM
?getTempFilesFullGRM
?RcppParallel::defaultNumThreads
RcppParallel::defaultNumThreads()
library(GRAB)
?GRAB.NullModel
?GRAB.NullModel
library(GRAB)
?GRAB.NullModel
?GRAB.NullModel
library(GRAB)
?GRAB.NullModel
library(GRAB)
library(GRAB)
?GRAB.NullModel
library(GRAB)
?GRAB.NullModel
library(GRAB)
?GRAB.NullModel
library(GRAB)
?GRAB.NullModel
sessionInfo()
library(roxygen2)
sessionInfo()
library(GRAB)
?GRAB.NullModel
library(GRAB)
?GRAB.NullModel
?GRAB.NullModel
library(GRAB)
library(GRAB)
?GRAB.NullModel
library(GRAB)
?GRAB.NullModel
?SKAT
?GRAB.NullModel
?SKAT
library(GRAB)
?GRAB.NullModel
library(GRAB)
?GRAB.NullModel
?RcppParallel::defaultNumThreads
?defaultNumThreads
library(GRAB)
?GRAB.NullModel
library(GRAB)
?GRAB.NullModel
library(GRAB)
?GRAB.NullModel
?GRAB.ReadGeno
library(GRAB)
?GRAB.NullModel
?GRAB.ReadGeno
library(GRAB)
?GRAB.ReadGeno
library(GRAB)
?GRAB.ReadGeno
data.table::fread(system.file("extdata", "simuBGEN.sample", package = "GRAB"))
library(GRAB)
?GRAB.ReadGeno
library(GRAB)
?checkIfSampleIDsExist
?GRAB.ReadGeno
?GRAB.ReadGeno
PLINKFile = system.file("extdata", "example.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE)) # If include/exclude files are not specified, then control$AllMarker should be TRUE
GenoMat = GenoList$GenoMat
markerInfo = GenoList$markerInfo
head(GenoMat[,1:15])
markerInfo
head(markerInfo)
RawFile = system.file("extdata", "example.raw", package = "GRAB")
GenoMat = data.table::fread(RawFile)
head(GenoMat[,1:15])
## The below is from PLINK input
PLINKFile = system.file("extdata", "example.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE)) # If include/exclude files are not specified, then control$AllMarker should be TRUE
GenoMat = GenoList$GenoMat
markerInfo = GenoList$markerInfo
system.file("extdata", "example.bed", package = "GRAB")
PLINKFile = system.file("extdata", "example.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE)) # If include/exclude files are not specified, then control$AllMarker should be TRUE
GenoMat = GenoList$GenoMat
head(GenoMat)
markerInfo = GenoList$markerInfo
head(GenoMat[,1:15])
head(markerInfo)
PLINKFile = system.file("extdata", "simuPLINK.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE)) # If include/exclude files are not specified, then control$AllMarker should be TRUE
GenoMat = GenoList$GenoMat
markerInfo = GenoList$markerInfo
head(GenoMat[,1:15])
head(markerInfo)
BGENFile = system.file("extdata", "simuBGEN.bgen", package = "GRAB")
GenoList = GRAB.ReadGeno(BGENFile)
GenoList = GRAB.ReadGeno(BGENFile, control = list(AllMarkers = TRUE))
GenoMat = GenoList$GenoMat
markerInfo = GenoList$markerInfo
head(GenoMat)
head(markerInfo)
library(GRAB)
?GRAB.ReadGeno
RawFile = system.file("extdata", "example.raw", package = "GRAB")
GenoMat = data.table::fread(RawFile)
head(GenoMat[,1:15])
## PLINK files
PLINKFile = system.file("extdata", "simuPLINK.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PLINKFile, control = list(AllMarkers = TRUE)) # If include/exclude files are not specified, then control$AllMarker should be TRUE
GenoMat = GenoList$GenoMat
markerInfo = GenoList$markerInfo
head(GenoMat[,1:15])
head(markerInfo)
## BGEN files (Note the different REF/ALT order for BGEN and PLINK formats)
BGENFile = system.file("extdata", "simuBGEN.bgen", package = "GRAB")
GenoList = GRAB.ReadGeno(BGENFile, control = list(AllMarkers = TRUE))
GenoMat = GenoList$GenoMat
markerInfo = GenoList$markerInfo
head(GenoMat)
head(markerInfo)
?GRAB.ReadGeno
RawFile = system.file("extdata", "example.raw", package = "GRAB")
GenoMat = data.table::fread(RawFile)
head(GenoMat[,1:15])
?plink.make
?GRAB.ReadGeno
?plink.make
getwd()
cat("Working directory:\t", getwd())
path.expand(getwd())
file.append(getwd(),"sdfs/sdfsd")
?file.append
file.append(getwd(),"/sdfs/sdfsd")
outputDir = system.file("results", package = "GRAB")
outputDir
paste0(outputDir, "/simuPLINK")
?GRAB.ReadGeno
?GRAB.NullModel
library(GRAB)
?makePlink
= 1000
m = 20
MAF = 0.3
GenoMat = matrix(rbinom(n*m, 2, MAF), n, m)
rownames(GenoMat) = paste0("Subj-",1:n)
colnames(GenoMat) = paste0("SNP-",1:m)
outputDir = system.file("results", package = "GRAB")
outputPrefix = paste0(outputDir, "/simuPLINK")
outputPrefix
makePlink(GenoMat, outputPrefix)
indexMissing = sample(n*m, 0.1*n*m)
GenoMat[indexMissing] = -9
makePlink(GenoMat, outputPrefix)
?makePlink
?GRAB.ReadGeno
?makePlink
library(GRAB)
?makePlink
n = 1000
m = 20
MAF = 0.3
GenoMat = matrix(rbinom(n*m, 2, MAF), n, m)
rownames(GenoMat) = paste0("Subj-",1:n)
colnames(GenoMat) = paste0("SNP-",1:m)
outputDir = system.file("results", package = "GRAB")
outputPrefix = paste0(outputDir, "/simuPLINK")
### Step 2(a): make PLINK files without missing genotype
makePlink(GenoMat, outputPrefix)
indexMissing = sample(n*m, 0.1*n*m)
GenoMat[indexMissing] = -9
makePlink(GenoMat, outputPrefix)
set.seed(123)
n = 20
subjData = paste0("ID-",1:n)
pheno = rbinom(n, 1, 0.5)
x1 = rnorm(n)
x2 = rnorm(n)
x3 = rbinom(n, 2, 0.5)
objFormula = handleFormula(pheno ~ x1+x2*x3, subset = x2>0, subjData = subjData)
objFormula
library(GRAB)
?GRAB.ReadGeno
?makePlink
Null
NULL
?makePlink
BGENFile = system.file("extdata", "example_bgen_1.2_8bits.bgen", package = "GRAB")
getVersionFromBGEN(BGENFile)
?getTempFilesFullGRM
?GRAB.Marker
?GRAB.Marker
?GRAB.NullModel
?SKAT
?GRAB.Marker
?GRAB.NullModel
?GRAB.Marker
library(GRAB)
?GRAB.Marker
library(GRAB)
library(GRAB)
?GRAB.Marker
library(GRAB)
?GRAB.Marker
library(GRAB)
library(GRAB)
?GRAB.Marker
?GRAB.Marker
library(GRAB)
?GRAB.Marker
library(GRAB)
?GRAB.Marker
library(GRAB)
?GRAB.Marker
?GRAB.Region
?GRAB.Region
library(GRAB)
?GRAB.Region
?GRAB.Region
library(GRAB)
?GRAB.Region
?SKAT
?GRAB.Region
12899+680+260+1299
sum(c(14499.00, 999.00, 299.00, 1399.00))
16299 * 0.97
library(GRAB)
?GRAB.Region
library(GRAB)
?GRAB.Region
library(GRAB)
?GRAB.Region
