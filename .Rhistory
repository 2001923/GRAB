Rcpp::sourceCpp('src/approxfun.cpp')
approxfun(2.5, 1:10, 1:10, 1, 10, 10)
approxfun(2.5, 1:10, 1:20, 1, 10, 10)
seq(1,10,0.5)
approxfun(2.5, seq(1,10,0.5), 1:19, 1, 19, 19)
seq(1,10,0.5)
approxfun(2.7, seq(1,10,0.5), 1:19, 1, 19, 19)
Rcpp::sourceCpp('src/temp.cpp')
Rcpp::sourceCpp('src/temp.cpp')
Rcpp::sourceCpp('src/temp.cpp')
mean(c(0.55391765,-0.06191171))
tempFun(2, xVec, yVec)
tempFun(3, xVec, yVec)
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
uniroot
Rcpp::sourceCpp('src/uniroot.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
Rcpp::sourceCpp('src/SPACOX.cpp')
help(SPACox::SPACox)
help(SPACox)
nData=10
nGeno=5
nBoth=3
rprintf("Number of subjects in 'formula':\t%d",nData)
rprintf("Number of subjects in 'GenoFile':\t%d",nGeno)
rprintf("Number of subjects in both 'formula' and 'GenoFile':\t%d",nBoth)
printf("Number of subjects in 'formula':\t%d",nData)
?
cat
print("a\t")
print("a\tb")
cat("a\tb")
cat("Number of subjects in 'formula':\t", nData)
cat("Number of subjects in 'GenoFile':\t", nGeno)
cat("Number of subjects in both 'formula' and 'GenoFile':\t", nBoth)
cat("Number of subjects in 'formula':\t", nData,"\n")
cat("Number of subjects in 'GenoFile':\t", nGeno,"\n")
cat("Number of subjects in both 'formula' and 'GenoFile':\t", nBoth,"\n")
?formula
?coxph
?survival::coxph
?survival::Surv
?survival::coxph
library(survival)
test1 <- list(time=c(4,3,1,1,2,2,3),
status=c(1,1,1,0,1,1,0),
x=c(0,2,1,1,1,0,0),
sex=c(0,0,0,0,1,1,1))
# Fit a stratified model
obj.coxph=coxph(Surv(time, status) ~ x + strata(sex), test1)
obj.coxph$na.action
test1$time[1]=NA
obj.coxph=coxph(Surv(time, status) ~ x + strata(sex), test1, x=T)
obj.coxph$na.action
c(obj.coxph$na.action)
options()\$na.action
a=options()
a$na.action
obj.coxph$n
obj.coxph$nevent
a=model.frame(Surv(time, status) ~ x + strata(sex), test1)
a$`Surv(time, status)`
a$x
a$`strata(sex)`
a
class(a)
rownames(a)
print(c("aa","bb"))
?SPACox
library(SPACox)
?SPACox
source('~/Github/GRAB/R/SPACox.R', echo=TRUE)
library(GRAB)
?GRAB.NullModel
library(GRAB)
?GRAB.NullModel
N = 10000
nSNP = 1000
MAF = 0.1
Pheno = data.frame(ID = paste0("IID-",1:N),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
Pheno
head(Pheno)
?readGeno
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
GenoMat = readGeno(GenoFile)
head(GenoMat)
dim(GenoMat)
rownames(GenoMat)
N=10
paste0("f",1:N,"_1")
?SPACox::SPACox
library(GRAB)
?GRAB.NullModel
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
library(GRAB)
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
library(GRAB)
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
library(GRAB)
?GRAB.NullModel
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
library(GRAB)
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
GRAB:::checkControl.NullModel.SPACox
library(GRAB)
?GRAB.NullModel
?GRAB::GRAB.NullModel
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
library(GRAB)
?GRAB.NullModel
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
obj.SPACox$Call
obj.SPACox$``
obj.SPACox = list(a=1,b=3)
obj.SPACox
obj.SPACox$csd=3
call()
Call
library(GRAB)
?GRAB.NullModel
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
obj.SPACox
library(GRAB)
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
obj.SPACox
library(GRAB)
?GRAB.ReadGeno
GRAB:::checkObjNull
?GRAB.NullModel
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
names(obj.SPACox)
?SPACox
?SPACox::SPACox
library(GRAB)
?GRAB.Marker
library(GRAB)
library(GRAB)
?GRAB.Marker
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
GRAB.Marker(obj.SPACox, GenoFile, chrom=1)
library(GRAB)
?GRAB.Marker
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
GRAB.Marker(obj.SPACox, GenoFile, chrom=1)
?SPACox::SPACox
?POLMM::POLMM.Marker
library(GRAB)
?GRAB.Marker
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
GRAB.Marker(obj.SPACox, GenoFile, chrom=1)
head(obj.SPACox$cumul)
obj.SPACox$cumul[,1]
plot(obj.SPACox$cumul[,1])
range(obj.SPACox$cumul[,1])
obj.SPACox$cumul[5000+(-10):10,1]
head(obj.SPACox$cumul)
tail(obj.SPACox$cumul)
library(GRAB)
?GRAB.Marker
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
GRAB.Marker(obj.SPACox, GenoFile, chrom=1)
library(GRAB)
?GRAB.Marker
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
GRAB.Marker(obj.SPACox, GenoFile, chrom=1)
library(GRAB)
?GRAB.Marker
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
GRAB.Marker(obj.SPACox, GenoFile, chrom=1)
library(GRAB)
?GRAB.Marker
# Simulation phenotype and genotype
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
GRAB.Marker(obj.SPACox, GenoFile, chrom=1)
library(GRAB)
?GRAB.Marker
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
names(obj.SPACox)
library(GRAB)
?GRAB.Marker
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
GRAB.Marker(obj.SPACox, GenoFile, chrom=1)
library(GRAB)
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
GRAB.Marker(obj.SPACox, GenoFile, chrom=1)
library(GRAB)
?GRAB.Marker
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
GRAB.Marker(obj.SPACox, GenoFile, chrom=1)
library(GRAB)
GRAB.Marker()
?GRAB.Marker
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
GRAB.Marker(obj.SPACox, GenoFile, chrom=1)
library(GRAB)
?GRAB.Marker
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
GRAB.Marker(obj.SPACox, GenoFile, chrom=1)
library(GRAB)
?GRAB.Marker
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
GRAB.Marker(obj.SPACox, GenoFile, chrom=1)
out = GRAB.Marker(obj.SPACox, GenoFile, chrom=1)
head(out)
dim(out)
range(out$Freq)
obj.SPACox$Call
obj.SPACox$control
?GRAB.Marker
?data.frame
?coxph
library(GRAB)
?SPACox
library(survival)
?coxph.object
coxph.object
?coxph.object
?data.frame
?factor
?`survival-internal`
?gbsg
library(roxygen2)
?roxygen2::rd_section
rd_roclet()
library(GRAB)
?GRAB.SPACox
GRAB.SPACox()
library(GRAB)
?GRAB.SPACox
?GRAB.Marker
?GRAB.NullModel
?GRAB.Marker
library(GRAB)
?GRAB.Marker
library(GRAB)
?GRAB.Marker
?GRAB.NullModel
?GRAB.NullModel
?coxph
library(GRAB)
?GRAB.NullModel
?GRAB.SPACox
?SPACox::SPACox_Null_Model
library(GRAB)
?GRAB.SPACox
?SPACox::SPACox
library(GRAB)
?GRAB.SPACox
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
res.SPACox = GRAB.Marker(obj.SPACox, GenoFile)
head(res.SPACox)
library(GRAB)
?GRAB.SPACox
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
res.SPACox = GRAB.Marker(obj.SPACox, GenoFile)
head(res.SPACox)
library(GRAB)
?GRAB.SPACox
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
res.SPACox = GRAB.Marker(obj.SPACox, GenoFile)
head(res.SPACox)
library(devtools)  # author version: 2.3.0
install_github("GeneticAnalysisinBiobanks/GRAB")
library(GRAB)
library(devtools)  # author version: 2.3.0
install_github("GeneticAnalysisinBiobanks/GRAB")
library(GRAB)
?GRAB.ReadGeno
?GRAB.SPACox
library(devtools)  # author version: 2.3.0
install_github("GeneticAnalysisinBiobanks/GRAB")
library(GRAB)
?GRAB.ReadGeno
?GRAB.SPACox
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
N = 100
Pheno = data.frame(ID = paste0("f",1:N,"_1"),
event=rbinom(N,1,0.5),
time=runif(N),
Cov1=rnorm(N),
Cov2=rbinom(N,1,0.5))
obj.SPACox = GRAB.NullModel(survival::Surv(time,event)~Cov1+Cov2,
data=Pheno, subjData = Pheno$ID, method = "SPACox", GenoFile = GenoFile)
res.SPACox = GRAB.Marker(obj.SPACox, GenoFile)
head(res.SPACox)
