?GRAB.ReadGeno
library(GRAB)
?GRAB.WtSPAG
setwd(system.file("WtSPAG", package = "GRAB"))
PhenoData = read.table(system.file("WtSPAG", "simuPHENO_WtSPAG.txt", package = "GRAB"), header = T)
RefPrevalence = 0.1
qcResult1 = QCforBatchEffect(GenoFile = "simuBGEN1.bgen",
GenoFileIndex = c("simuBGEN1.bgen.bgi",
"simuBGEN1.sample"),
control=list(AlleleOrder = "ref-first",
AllMarkers = T,
IndicatorColumn = "SurvEvent", SampleIDColumn = "IID"),
PhenoData=PhenoData,
RefAfFile = "RefMAFs.txt",
RefPrevalence = RefPrevalence,
SNPnum=1e4)
qcResult2 = QCforBatchEffect(GenoFile = "simuBGEN2.bgen",
GenoFileIndex = c("simuBGEN2.bgen.bgi",
"simuBGEN2.sample"),
control=list(AlleleOrder = "ref-first",
AllMarkers = T,
IndicatorColumn = "SurvEvent", SampleIDColumn = "IID"),
PhenoData=PhenoData,
RefAfFile = "RefMAFs.txt",
RefPrevalence = RefPrevalence,
SNPnum=1e4)
allQC = mergeQCresults(qcResult1,qcResult2)
obj.WtSPAG = GRAB.NullModel(Surv(SurvTime, SurvEvent) ~ Cov1 + Cov2,
data = PhenoData,
subjData = IID,
method = "WtSPAG",
traitType = "time-to-event",
control = list(RefPrevalance = 0.1))
?GRAB.NullModel
?GRAB.WtSPAG
subjData = IID
library(survival)
head(PhenoData)
with(response = Surv(SurvTime, SurvEvent))
with(PhenoData, response = Surv(SurvTime, SurvEvent))
?Surv
response = Surv(PhenoData$SurvTime, PhenoData$SurvEvent)
response
head(response)
head(as.matrix(response))
response
names(response)
a=Surv(heart$start, heart$stop, heart$event)
a
as.matrix(a)
head(as.matrix(a))
as.matrix(a)["status"]
as.matrix(a)[,"status"]
GRAB::Get_Weights()
GRAB::Get_Weights
library(GRAB)
?GRAB.WtSPAG
setwd(system.file("WtSPAG", package = "GRAB"))
PhenoData = read.table(system.file("WtSPAG", "simuPHENO_WtSPAG.txt", package = "GRAB"), header = T)
RefPrevalence = 0.1
qcResult1 = QCforBatchEffect(GenoFile = "simuBGEN1.bgen",
GenoFileIndex = c("simuBGEN1.bgen.bgi",
"simuBGEN1.sample"),
control=list(AlleleOrder = "ref-first",
AllMarkers = T,
IndicatorColumn = "SurvEvent", SampleIDColumn = "IID"),
PhenoData=PhenoData,
RefAfFile = "RefMAFs.txt",
RefPrevalence = RefPrevalence,
SNPnum=1e4)
qcResult2 = QCforBatchEffect(GenoFile = "simuBGEN2.bgen",
GenoFileIndex = c("simuBGEN2.bgen.bgi",
"simuBGEN2.sample"),
control=list(AlleleOrder = "ref-first",
AllMarkers = T,
IndicatorColumn = "SurvEvent", SampleIDColumn = "IID"),
PhenoData=PhenoData,
RefAfFile = "RefMAFs.txt",
RefPrevalence = RefPrevalence,
SNPnum=1e4)
allQC = mergeQCresults(qcResult1,qcResult2)
obj.WtSPAG = GRAB.NullModel(Surv(SurvTime, SurvEvent) ~ Cov1 + Cov2,
data = PhenoData,
subjData = IID,
method = "WtSPAG",
traitType = "time-to-event",
control = list(RefPrevalance = RefPrevalence,
IndicatorColumn = "SurvEvent"))
RefPrevalence
library(GRAB)
?GRAB.WtSPAG
setwd(system.file("WtSPAG", package = "GRAB"))
PhenoData = read.table(system.file("WtSPAG", "simuPHENO_WtSPAG.txt", package = "GRAB"), header = T)
RefPrevalence = 0.1
obj.WtSPAG = GRAB.NullModel(Surv(SurvTime, SurvEvent) ~ Cov1 + Cov2,
data = PhenoData,
subjData = IID,
method = "WtSPAG",
traitType = "time-to-event",
control = list(Refprevalence = RefPrevalence,
IndicatorColumn = "SurvEvent"))
library(GRAB)
?GRAB.WtSPAG
setwd(system.file("WtSPAG", package = "GRAB"))
PhenoData = read.table(system.file("WtSPAG", "simuPHENO_WtSPAG.txt", package = "GRAB"), header = T)
RefPrevalence = 0.1
obj.WtSPAG = GRAB.NullModel(Surv(SurvTime, SurvEvent) ~ Cov1 + Cov2,
data = PhenoData,
subjData = IID,
method = "WtSPAG",
traitType = "time-to-event",
control = list(RefPrevalence = RefPrevalence,
IndicatorColumn = "SurvEvent"))
summary(obj.WtSPAG$mresid)
summary(obj.WtSPAG)
obj.WtSPAG$Call
library(GRAB)
?GRAB.getGenoInfo
?GRAB.WtSPAG
library(GRAB)
?GRAB.WtSPAG
setwd(system.file("WtSPAG", package = "GRAB"))
PhenoData = read.table(system.file("WtSPAG", "simuPHENO_WtSPAG.txt", package = "GRAB"), header = T)
RefPrevalence = 0.1
obj.WtSPAG = GRAB.NullModel(Surv(SurvTime, SurvEvent) ~ Cov1 + Cov2,
data = PhenoData,
subjData = IID,
method = "WtSPAG",
traitType = "time-to-event",
control = list(RefPrevalence = RefPrevalence))
sum(obj.WtSPAG$mresid * obj.WtSPAG$weight)
with(obj.WtSPAG, plot(weight))
?GRAB.Marker
class(obj.WtSPAG)
GRAB.Marker(obj.WtSPAG,
GenoFile = "simuBGEN1.bgen",
GenoFileIndex = c("simuBGEN1.bgen.bgi", "simuBGEN1.sample"),
OutputFile = "simuBGEN1.txt",
OutputFileIndex = NULL,
control = list(AlleleOrder = "ref-first",
AllMarkers = T))
?GRAB.WtSPAG
setwd(system.file("WtSPAG", package = "GRAB"))
PhenoData = read.table(system.file("WtSPAG", "simuPHENO_WtSPAG.txt", package = "GRAB"), header = T)
RefPrevalence = 0.1
qcResult1 = QCforBatchEffect(GenoFile = "simuBGEN1.bgen",
GenoFileIndex = c("simuBGEN1.bgen.bgi",
"simuBGEN1.sample"),
control=list(AlleleOrder = "ref-first",
AllMarkers = T,
IndicatorColumn = "SurvEvent", SampleIDColumn = "IID"),
PhenoData=PhenoData,
RefAfFile = "RefMAFs.txt",
RefPrevalence = RefPrevalence,
SNPnum=1e4)
qcResult1
qcResult1$mergeGenoInfo
table(is.na(qcResult1$mergeGenoInfo$AN_ref))
qcResult1$mergeGenoInfo %>% filter(is.na(AN_ref)) %>% head()
RefMAFs = data.table::fread("RefMAFs.txt")
RefMAFs %>% head()
RefMAFs %>% filter(is.na(AF_ref)) %>% head()
RefMAFs %>% filter(POS == 48)
qcResult1$mergeGenoInfo %>% head()
RefMAFs %>% head()
SNPIDs = qcResult1$mergeGenoInfo %>% filter(is.na(AN_ref)) %>% select(ID)
SNPIDs
SNPIDs = unlist(SNPIDs)
SNPIDs
RefMAFs %>% head()
RefMAFs %>% filter(ID %in% SNPIDs) %>% head()
RefMAFs %>% filter(ID %in% SNPIDs) %>% select(AF_ref) %>% summary()
RefMAFs %>% filter(ID %in% SNPIDs) %>% select(AF_ref) %>% head()qcResult1$mergeGenoInfo
qcResult1$mergeGenoInfo %>% head()
qcResult1$mergeGenoInfo %>% filter(is.na(AN_ref))
GenoFile = "simuBGEN1.bgen"
GenoFileIndex = c("simuBGEN1.bgen.bgi", "simuBGEN1.sample")
?GRAB.WtSPAG
GenoFile = "simuBGEN1.bgen"
GenoFileIndex = c("simuBGEN1.bgen.bgi", "simuBGEN1.sample")
control = list(AlleleOrder = "ref-first",
AllMarkers = T)
GenoInfo.ctrl = GRAB.getGenoInfo(GenoFile = GenoFile
,GenoFileIndex = GenoFileIndex
# ,SampleIDs = with(PhenoData,SampleID[Indicator==0])
,control = control)
GenoInfo.ctrl %>% head()
GenoInfo.ctrl %>% filter(REF == "A") %>% head()
GenoInfo.ctrl %>% select(altFreq) %>% summary()
list(
a=1,
b=2)
library(GRAB)
?GRAB.WtSPAG
setwd(system.file("WtSPAG", package = "GRAB"))
PhenoData = read.table(system.file("WtSPAG", "simuPHENO_WtSPAG.txt", package = "GRAB"), header = T)
RefPrevalence = 0.1
qcResult1 = QCforBatchEffect(GenoFile = "simuBGEN1.bgen",
GenoFileIndex = c("simuBGEN1.bgen.bgi",
"simuBGEN1.sample"),
OutputFile = "qcBGEN1.txt",
control=list(AlleleOrder = "ref-first",
AllMarkers = T,
IndicatorColumn = "SurvEvent", SampleIDColumn = "IID"),
PhenoData=PhenoData,
RefAfFile = "RefMAFs.txt",
RefPrevalence = RefPrevalence,
SNPnum=1e4)
qcResult1
getwd()
qcResult2 = QCforBatchEffect(GenoFile = "simuBGEN2.bgen",
GenoFileIndex = c("simuBGEN2.bgen.bgi",
"simuBGEN2.sample"),
OutputFile = "qcBGEN2.txt",
control=list(AlleleOrder = "ref-first",
AllMarkers = T,
IndicatorColumn = "SurvEvent", SampleIDColumn = "IID"),
PhenoData=PhenoData,
RefAfFile = "RefMAFs.txt",
RefPrevalence = RefPrevalence,
SNPnum=1e4)
allQC = mergeQCresults(qcResult1, qcResult2)
allQC
qcResult1$cutoff
GRAB.Marker(obj.WtSPAG,
GenoFile = "simuBGEN1.bgen",
GenoFileIndex = c("simuBGEN1.bgen.bgi", "simuBGEN1.sample"),
OutputFile = "simuBGEN1.txt",
OutputFileIndex = NULL,
control = list(QCFile = "qcBGEN1.txt",
AlleleOrder = "ref-first",
AllMarkers = T))
setwd(system.file("WtSPAG", package = "GRAB"))
PhenoData = read.table(system.file("WtSPAG", "simuPHENO_WtSPAG.txt", package = "GRAB"), header = T)
RefPrevalence = 0.1
qcResult1 = QCforBatchEffect(GenoFile = "simuBGEN1.bgen",
GenoFileIndex = c("simuBGEN1.bgen.bgi",
"simuBGEN1.sample"),
OutputFile = "qcBGEN1.txt",
control=list(AlleleOrder = "ref-first",
AllMarkers = T,
IndicatorColumn = "SurvEvent", SampleIDColumn = "IID"),
PhenoData=PhenoData,
RefAfFile = "RefMAFs.txt",
RefPrevalence = RefPrevalence,
SNPnum=1e4)
qcResult2 = QCforBatchEffect(GenoFile = "simuBGEN2.bgen",
GenoFileIndex = c("simuBGEN2.bgen.bgi",
"simuBGEN2.sample"),
OutputFile = "qcBGEN2.txt",
control=list(AlleleOrder = "ref-first",
AllMarkers = T,
IndicatorColumn = "SurvEvent", SampleIDColumn = "IID"),
PhenoData=PhenoData,
RefAfFile = "RefMAFs.txt",
RefPrevalence = RefPrevalence,
SNPnum=1e4)
allQC = mergeQCresults(qcResult1, qcResult2)
obj.WtSPAG = GRAB.NullModel(Surv(SurvTime, SurvEvent) ~ Cov1 + Cov2,
data = PhenoData,
subjData = IID,
method = "WtSPAG",
traitType = "time-to-event",
control = list(RefPrevalence = RefPrevalence))
names(obj.WtSPAG)
GRAB.Marker(obj.WtSPAG,
GenoFile = "simuBGEN1.bgen",
GenoFileIndex = c("simuBGEN1.bgen.bgi", "simuBGEN1.sample"),
OutputFile = "simuBGEN1.txt",
OutputFileIndex = NULL,
control = list(QCFile = "qcBGEN1.txt",
AlleleOrder = "ref-first",
AllMarkers = T))
class(obj.WtSPAG)
?GRAB.WtSPAG
?GRAB.WtSPAG
QCFile = "simuBGEN1.txt"
QCData = data.table::fread(QCFile)
setwd(system.file("WtSPAG", package = "GRAB"))
PhenoData = read.table(system.file("WtSPAG", "simuPHENO_WtSPAG.txt", package = "GRAB"), header = T)
RefPrevalence = 0.1
qcResult1 = QCforBatchEffect(GenoFile = "simuBGEN1.bgen",
GenoFileIndex = c("simuBGEN1.bgen.bgi",
"simuBGEN1.sample"),
OutputFile = "qcBGEN1.txt",
control=list(AlleleOrder = "ref-first",
AllMarkers = T,
IndicatorColumn = "SurvEvent", SampleIDColumn = "IID"),
PhenoData=PhenoData,
RefAfFile = "RefMAFs.txt",
RefPrevalence = RefPrevalence,
SNPnum=1e4)
QCData = data.table::fread(QCFile)
QCFile
QCFile = "qcBGEN1.txt"
QCData = data.table::fread(QCFile)
QCData %>% head()
getwd()
library(GRAB)
?GRAB.WtSPAG
setwd(system.file("WtSPAG", package = "GRAB"))
PhenoData = read.table(system.file("WtSPAG", "simuPHENO_WtSPAG.txt", package = "GRAB"), header = T)
RefPrevalence = 0.1
qcResult1 = QCforBatchEffect(GenoFile = "simuBGEN1.bgen",
GenoFileIndex = c("simuBGEN1.bgen.bgi",
"simuBGEN1.sample"),
OutputFile = "qcBGEN1.txt",
control=list(AlleleOrder = "ref-first",
AllMarkers = T,
IndicatorColumn = "SurvEvent", SampleIDColumn = "IID"),
PhenoData=PhenoData,
RefAfFile = "RefMAFs.txt",
RefPrevalence = RefPrevalence,
SNPnum=1e4)
QCFile = "qcBGEN1.txt"
QCData = data.table::fread(QCFile)
QCData %>% head()
QCData = QCData %>% select(genoIndex, pvalue_bat)
QCData %>% head()
library(GRAB)
?GRAB.WtSPAG
setwd(system.file("WtSPAG", package = "GRAB"))
PhenoData = read.table(system.file("WtSPAG", "simuPHENO_WtSPAG.txt", package = "GRAB"), header = T)
RefPrevalence = 0.1
qcResult1 = QCforBatchEffect(GenoFile = "simuBGEN1.bgen",
GenoFileIndex = c("simuBGEN1.bgen.bgi",
"simuBGEN1.sample"),
OutputFile = "qcBGEN1.txt",
control=list(AlleleOrder = "ref-first",
AllMarkers = T,
IndicatorColumn = "SurvEvent", SampleIDColumn = "IID"),
PhenoData=PhenoData,
RefAfFile = "RefMAFs.txt",
RefPrevalence = RefPrevalence,
SNPnum=1e4)
obj.WtSPAG = GRAB.NullModel(Surv(SurvTime, SurvEvent) ~ Cov1 + Cov2,
data = PhenoData,
subjData = IID,
method = "WtSPAG",
traitType = "time-to-event",
control = list(RefPrevalence = RefPrevalence))
GRAB.Marker(obj.WtSPAG,
GenoFile = "simuBGEN1.bgen",
GenoFileIndex = c("simuBGEN1.bgen.bgi", "simuBGEN1.sample"),
OutputFile = "simuBGEN1.txt",
OutputFileIndex = NULL,
control = list(QCFile = "qcBGEN1.txt",
QCCutoff = qcResult1$cutoff,
AlleleOrder = "ref-first",
AllMarkers = T))
library(GRAB)
?GRAB.WtSPAG
setwd(system.file("WtSPAG", package = "GRAB"))
PhenoData = read.table(system.file("WtSPAG", "simuPHENO_WtSPAG.txt", package = "GRAB"), header = T)
RefPrevalence = 0.1
qcResult1 = QCforBatchEffect(GenoFile = "simuBGEN1.bgen",
GenoFileIndex = c("simuBGEN1.bgen.bgi",
"simuBGEN1.sample"),
OutputFile = "qcBGEN1.txt",
control=list(AlleleOrder = "ref-first",
AllMarkers = T,
IndicatorColumn = "SurvEvent", SampleIDColumn = "IID"),
PhenoData=PhenoData,
RefAfFile = "RefMAFs.txt",
RefPrevalence = RefPrevalence,
SNPnum=1e4)
obj.WtSPAG = GRAB.NullModel(Surv(SurvTime, SurvEvent) ~ Cov1 + Cov2,
data = PhenoData,
subjData = IID,
method = "WtSPAG",
traitType = "time-to-event",
control = list(RefPrevalence = RefPrevalence))
names(obj.WtSPAG)
GRAB.Marker(obj.WtSPAG,
GenoFile = "simuBGEN1.bgen",
GenoFileIndex = c("simuBGEN1.bgen.bgi", "simuBGEN1.sample"),
OutputFile = "simuBGEN1.txt",
OutputFileIndex = NULL,
control = list(QCFile = "qcBGEN1.txt",
QCCutoff = qcResult1$cutoff,
AlleleOrder = "ref-first",
AllMarkers = T))
library(GRAB)
?GRAB.WtSPAG
setwd(system.file("WtSPAG", package = "GRAB"))
PhenoData = read.table(system.file("WtSPAG", "simuPHENO_WtSPAG.txt", package = "GRAB"), header = T)
RefPrevalence = 0.1
qcResult1 = QCforBatchEffect(GenoFile = "simuBGEN1.bgen",
GenoFileIndex = c("simuBGEN1.bgen.bgi",
"simuBGEN1.sample"),
OutputFile = "qcBGEN1.txt",
control=list(AlleleOrder = "ref-first",
AllMarkers = T,
IndicatorColumn = "SurvEvent", SampleIDColumn = "IID"),
PhenoData=PhenoData,
RefAfFile = "RefMAFs.txt",
RefPrevalence = RefPrevalence,
SNPnum=1e4)
obj.WtSPAG = GRAB.NullModel(Surv(SurvTime, SurvEvent) ~ Cov1 + Cov2,
data = PhenoData,
subjData = IID,
method = "WtSPAG",
traitType = "time-to-event",
control = list(RefPrevalence = RefPrevalence))
names(obj.WtSPAG)
GRAB.Marker(obj.WtSPAG,
GenoFile = "simuBGEN1.bgen",
GenoFileIndex = c("simuBGEN1.bgen.bgi", "simuBGEN1.sample"),
OutputFile = "simuBGEN1.txt",
OutputFileIndex = NULL,
control = list(QCFile = "qcBGEN1.txt",
QCCutoff = qcResult1$cutoff,
AlleleOrder = "ref-first",
AllMarkers = T))
getwd()
library(GRAB)
?GRAB.WtSPAG
setwd(system.file("WtSPAG", package = "GRAB"))
PhenoData = read.table(system.file("WtSPAG", "simuPHENO_WtSPAG.txt", package = "GRAB"), header = T)
RefPrevalence = 0.1
qcResult1 = QCforBatchEffect(GenoFile = "simuBGEN1.bgen",
GenoFileIndex = c("simuBGEN1.bgen.bgi",
"simuBGEN1.sample"),
OutputFile = "qcBGEN1.txt",
control=list(AlleleOrder = "ref-first",
AllMarkers = T,
IndicatorColumn = "SurvEvent", SampleIDColumn = "IID"),
PhenoData=PhenoData,
RefAfFile = "RefMAFs.txt",
RefPrevalence = RefPrevalence,
SNPnum=1e4)
setwd(system.file("WtSPAG", package = "GRAB"))
PhenoData = read.table(system.file("WtSPAG", "simuPHENO_WtSPAG.txt", package = "GRAB"), header = T)
RefPrevalence = 0.1
qcResult1 = QCforBatchEffect(GenoFile = "simuBGEN1.bgen",
GenoFileIndex = c("simuBGEN1.bgen.bgi",
"simuBGEN1.sample"),
OutputFile = "qcBGEN1.txt",
control=list(AlleleOrder = "ref-first",
AllMarkers = T,
IndicatorColumn = "SurvEvent", SampleIDColumn = "IID"),
PhenoData=PhenoData,
RefAfFile = "RefMAFs.txt",
RefPrevalence = RefPrevalence,
SNPnum=1e4)
data.table::fread("simuBGEN1.txt")
GRAB.Marker(obj.WtSPAG,
GenoFile = "simuBGEN1.bgen",
GenoFileIndex = c("simuBGEN1.bgen.bgi", "simuBGEN1.sample"),
OutputFile = "simuBGEN1.txt",
OutputFileIndex = NULL,
control = list(QCFile = "qcBGEN1.txt",
QCCutoff = qcResult1$cutoff,
AlleleOrder = "ref-first",
AllMarkers = T))
obj.WtSPAG = GRAB.NullModel(Surv(SurvTime, SurvEvent) ~ Cov1 + Cov2,
data = PhenoData,
subjData = IID,
method = "WtSPAG",
traitType = "time-to-event",
control = list(RefPrevalence = RefPrevalence))
names(obj.WtSPAG)
GRAB.Marker(obj.WtSPAG,
GenoFile = "simuBGEN1.bgen",
GenoFileIndex = c("simuBGEN1.bgen.bgi", "simuBGEN1.sample"),
OutputFile = "simuBGEN1.txt",
OutputFileIndex = NULL,
control = list(QCFile = "qcBGEN1.txt",
QCCutoff = qcResult1$cutoff,
AlleleOrder = "ref-first",
AllMarkers = T))
data.table::fread("simuBGEN1.txt")
library(GRAB)
?GRAB.WtSPAG
library(GRAB)
?GRAB.WtSPAG
setwd(system.file("WtSPAG", package = "GRAB"))
PhenoData = read.table(system.file("WtSPAG", "simuPHENO_WtSPAG.txt", package = "GRAB"), header = T)
RefPrevalence = 0.1
qcResult1 = QCforBatchEffect(GenoFile = "simuBGEN1.bgen",
GenoFileIndex = c("simuBGEN1.bgen.bgi",
"simuBGEN1.sample"),
OutputFile = "qcBGEN1.txt",
control=list(AlleleOrder = "ref-first",
AllMarkers = T,
IndicatorColumn = "SurvEvent", SampleIDColumn = "IID"),
PhenoData=PhenoData,
RefAfFile = "RefMAFs.txt",
RefPrevalence = RefPrevalence,
SNPnum=1e4)
obj.WtSPAG = GRAB.NullModel(Surv(SurvTime, SurvEvent) ~ Cov1 + Cov2,
data = PhenoData,
subjData = IID,
method = "WtSPAG",
traitType = "time-to-event",
control = list(RefPrevalence = RefPrevalence))
names(obj.WtSPAG)
GRAB.Marker(obj.WtSPAG,
GenoFile = "simuBGEN1.bgen",
GenoFileIndex = c("simuBGEN1.bgen.bgi", "simuBGEN1.sample"),
OutputFile = "simuBGEN1.txt",
OutputFileIndex = NULL,
control = list(QCFile = "qcBGEN1.txt",
QCCutoff = qcResult1$cutoff,
AlleleOrder = "ref-first",
AllMarkers = T))
data.table::fread('simuBGEN1.txt')
a=data.table::fread('simuBGEN1.txt')
table(a$Pvalue == 0)
a %>% filter(Pvalue != 0) %>% select(Pvalue) %>% hist()
a %>% filter(Pvalue != 0) %>% select(Pvalue) %>% as.numeric() %>% hist()
a %>% filter(Pvalue != 0) %>% select(Pvalue) %>% unlist() %>% as.numeric() %>% hist()
