load("obj.POLMM.RData")
obj.POLMM$tau
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
setwd("C:/Users/wenji/OneDrive/Documents/Github")
load("obj.POLMM.RData")
IDsToIncludeFile = system.file("extdata", "IDsToInclude.txt", package = "GRAB")
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/POLMMMarkers.txt")
GRAB.Marker(obj.POLMM, GenoFile = GenoFile,
OutputFile = OutputFile,
control = list(IDsToIncludeFile = IDsToIncludeFile))
read.table("C:/Users/wenji/OneDrive/Documents/R/win-library/4.0/GRAB/results/POLMMMarkers.txt", header = T)
head(read.table("C:/Users/wenji/OneDrive/Documents/Github/POLMM.txt", header = T))
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
setwd("C:/Users/wenji/OneDrive/Documents/Github")
load("obj.POLMM.RData")
IDsToIncludeFile = system.file("extdata", "IDsToInclude.txt", package = "GRAB")
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/POLMMMarkers.txt")
GRAB.Marker(obj.POLMM, GenoFile = GenoFile,
OutputFile = OutputFile,
control = list(IDsToIncludeFile = IDsToIncludeFile))
read.table("C:/Users/wenji/OneDrive/Documents/R/win-library/4.0/GRAB/results/POLMMMarkers.txt", header = T)
head(read.table("C:/Users/wenji/OneDrive/Documents/Github/POLMM.txt", header = T))
aaaInGRAB = obj.POLMM$LOCOList$`LOCO=F`
aaaInGRAB$VarRatio
aaaInGRAB$VarRatio
library(POLMM)
obj.POLMM = POLMM_Null_Model(factor(Ordinal) ~ Cova1 + Cova2, PhenoData, PhenoData$IID,
"C:/Users/wenji/OneDrive/Documents/R/win-library/4.0/GRAB/extdata/example",
control = list(showInfo = FALSE, LOCO = FALSE, tolTau = 0.2, tolBeta = 0.1))
aaaInPOLMM=obj.POLMM$LOCOList$`LOCO=F`
aaaInGRAB$VarRatio
aaaInPOLMM$VarRatio
head(aaaInGRAB$VarRatioMat)
head(aaaInPOLMM$VarRatioMat)
obj.POLMM = POLMM_Null_Model(factor(Ordinal) ~ Cova1 + Cova2, PhenoData, PhenoData$IID,
"C:/Users/wenji/OneDrive/Documents/R/win-library/4.0/GRAB/extdata/example",
control = list(showInfo = FALSE, LOCO = FALSE, tolTau = 0.2, tolBeta = 0.1))
bbbInPOLMM=obj.POLMM$LOCOList$`LOCO=F`
bbbInPOLMM$VarRatioMat
bbbInPOLMM$VarRatioMat
aaaInGRAB$VarRatioMat
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
PhenoData = read.table(system.file("extdata", "example.pheno", package = "GRAB"), header = T)
GenoFile = system.file("extdata", "example.bed", package = "GRAB")
obj.POLMM = GRAB.NullModel(factor(Ordinal) ~ Cova1 + Cova2,
data = PhenoData, subjData = PhenoData$IID, method = "POLMM", traitType = "ordinal",
GenoFile = GenoFile,
control = list(showInfo = FALSE, LOCO = FALSE, tolTau = 0.2, tolBeta = 0.1
))
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
PhenoData = read.table(system.file("extdata", "example.pheno", package = "GRAB"), header = T)
GenoFile = system.file("extdata", "example.bed", package = "GRAB")
obj.POLMM = GRAB.NullModel(factor(Ordinal) ~ Cova1 + Cova2,
data = PhenoData, subjData = PhenoData$IID, method = "POLMM", traitType = "ordinal",
GenoFile = GenoFile,
control = list(showInfo = FALSE, LOCO = FALSE, tolTau = 0.2, tolBeta = 0.1))
library(GRAB)
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
PhenoData = read.table(system.file("extdata", "example.pheno", package = "GRAB"), header = T)
GenoFile = system.file("extdata", "example.bed", package = "GRAB")
obj.POLMM = GRAB.NullModel(factor(Ordinal) ~ Cova1 + Cova2,
data = PhenoData, subjData = PhenoData$IID, method = "POLMM", traitType = "ordinal",
GenoFile = GenoFile,
control = list(showInfo = FALSE, LOCO = FALSE, tolTau = 0.2, tolBeta = 0.1))
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
PhenoData = read.table(system.file("extdata", "example.pheno", package = "GRAB"), header = T)
GenoFile = system.file("extdata", "example.bed", package = "GRAB")
obj.POLMM = GRAB.NullModel(factor(Ordinal) ~ Cova1 + Cova2,
data = PhenoData, subjData = PhenoData$IID, method = "POLMM", traitType = "ordinal",
GenoFile = GenoFile,
control = list(showInfo = FALSE, LOCO = FALSE, tolTau = 0.2, tolBeta = 0.1))
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
PhenoData = read.table(system.file("extdata", "example.pheno", package = "GRAB"), header = T)
GenoFile = system.file("extdata", "example.bed", package = "GRAB")
obj.POLMM = GRAB.NullModel(factor(Ordinal) ~ Cova1 + Cova2,
data = PhenoData, subjData = PhenoData$IID, method = "POLMM", traitType = "ordinal",
GenoFile = GenoFile,
control = list(showInfo = FALSE, LOCO = FALSE, tolTau = 0.2, tolBeta = 0.1))
setwd("C:/Users/wenji/OneDrive/Documents/Github")
save(obj.POLMM, file = "obj.POLMM.RData")
aaaInGRAB = obj.POLMM$LOCOList$`LOCO=F`
aaaInGRAB$VarRatio
aaaInGRAB$VarRatioMat
library(POLMM)
obj.POLMM = POLMM_Null_Model(factor(Ordinal) ~ Cova1 + Cova2, PhenoData, PhenoData$IID,
"C:/Users/wenji/OneDrive/Documents/R/win-library/4.0/GRAB/extdata/example",
control = list(showInfo = FALSE, LOCO = FALSE, tolTau = 0.2, tolBeta = 0.1))
bbbInPOLMM=obj.POLMM$LOCOList$`LOCO=F`
bbbInPOLMM$VarRatioMat
aaaInGRAB$VarRatioMat
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
library(devtools)  # author version: 2.3.0
install_github("GeneticAnalysisinBiobanks/GRAB", INSTALL_opts=c("--no-multiarch"))
install_github("GeneticAnalysisinBiobanks/GRAB", INSTALL_opts=c("--no-multiarch"))
library(GRAB)
sessionInfo()
?GRAB.SimubVec
?GRAB.POLMM
# Step 1: fit a null model
PhenoData = read.table(system.file("extdata", "example.pheno", package = "GRAB"), header = T)
GenoFile = system.file("extdata", "example.bed", package = "GRAB")
obj.POLMM = GRAB.NullModel(factor(Ordinal) ~ Cova1 + Cova2,
data = PhenoData, subjData = PhenoData$IID, method = "POLMM", traitType = "ordinal",
GenoFile = GenoFile,
control = list(showInfo = FALSE, LOCO = FALSE, tolTau = 0.2, tolBeta = 0.1))
names(obj.POLMM)
obj.POLMM$tau    # 1.820102
# Step 2: perform score test
GenoFile = system.file("extdata", "nSNPs-10000-nsubj-1000-ext.bed", package = "GRAB")
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/POLMMMarkers.txt")
GRAB.Marker(obj.POLMM, GenoFile = GenoFile,
OutputFile = OutputFile)
?GRAB.POLMM
GenoFile = system.file("extdata", "example.bed", package = "GRAB")
bimData = read.table(gsub("bed", "bim", GenoFile))
head(bimData)
?GRAB.Region
?GRAB.ReadGeno
PlinkFile = system.file("extdata", "example.bed", package = "GRAB")
GenoList = GRAB.ReadGeno(PlinkFile)
GenoMat = GenoList$GenoMat
markerInfo = GenoList$markerInfo
head(markerInfo)
OUTPUT = read.table("C:/Users/wenji/OneDrive/Documents/R/win-library/4.0/GRAB/results/POLMMMarkers.txt")
OUTPUT
dim(OUTPUT)
OUTPUT = read.table("C:/Users/wenji/OneDrive/Documents/R/win-library/4.0/GRAB/results/POLMMMarkers.txt", header = T)
head(OUTPUT)
head(OUTPUT)
rangeOUTPUT$AltFreq)
range(OUTPUT$AltFreq)
OUTPUT[head(order(OUTPUT$AltFreq)),]
library(devtools)  # author version: 2.3.0
install_github("WenjianBi/POLMM")
library(POLMM)
obj.POLMM = POLMM_Null_Model(factor(Ordinal) ~ Cova1 + Cova2, PhenoData, PhenoData$IID,
"C:/Users/wenji/OneDrive/Documents/R/win-library/4.0/GRAB/extdata/example",
control = list(showInfo = FALSE, LOCO = FALSE, tolTau = 0.2, tolBeta = 0.1))
GenoFile = system.file("extdata", "example.bed", package = "GRAB")
PlinkFile = gsub(".bed$", "", GenoFile)
output.file = "C:/Users/wenji/OneDrive/Documents/Github/POLMM.txt"
POLMM.plink(
obj.POLMM,
PlinkFile,
output.file,
"1",
memory.chunk = 4,
SPAcutoff = 2,
minMAF = 1e-04,
maxMissing = 0.15,
impute.method = "fixed",
G.model = "Add"
)
POLMM.plink(
obj.POLMM,
PlinkFile,
output.file,
"1",
memory.chunk = 4,
SPAcutoff = 2,
minMAF = 1e-04,
maxMissing = 0.15,
impute.method = "fixed",
G.model = "Add"
)
PhenoData = read.table(system.file("extdata", "example.pheno", package = "GRAB"), header = T)
GenoFile = system.file("extdata", "example.bed", package = "GRAB")
obj.POLMM = GRAB.NullModel(factor(Ordinal) ~ Cova1 + Cova2,
data = PhenoData, subjData = PhenoData$IID, method = "POLMM", traitType = "ordinal",
GenoFile = GenoFile,
control = list(showInfo = FALSE, LOCO = FALSE, tolTau = 0.2, tolBeta = 0.1))
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/POLMMMarkers.txt")
GRAB.Marker(obj.POLMM, GenoFile = GenoFile,
OutputFile = OutputFile)
OutputDir
GRAB.Marker(obj.POLMM, GenoFile = GenoFile,
OutputFile = OutputFile)
POLMM = read.table(output.file)
GRAB = read.table(OutputFile)
head(POLMM)
head(GRAB)
POLMM = read.table(output.file, header = T)
GRAB = read.table(OutputFile, header = T)
head(POLMM)
head(GRAB)
a1=obj.POLMM$LOCOList$`LOCO=F`
head(a1$VarRatioMat)
PhenoData = read.table(system.file("extdata", "example.pheno", package = "GRAB"), header = T)
GenoFile = system.file("extdata", "example.bed", package = "GRAB")
obj.GRAB = GRAB.NullModel(factor(Ordinal) ~ Cova1 + Cova2,
data = PhenoData, subjData = PhenoData$IID, method = "POLMM", traitType = "ordinal",
GenoFile = GenoFile,
control = list(showInfo = FALSE, LOCO = FALSE, tolTau = 0.2, tolBeta = 0.1))
a1 = obj.GRAB$LOCOList$`LOCO=F`
a1 = obj.GRAB$LOCOList$`LOCO=F`
head(a1$VarRatioMat)
obj.POLMM = POLMM_Null_Model(factor(Ordinal) ~ Cova1 + Cova2, PhenoData, PhenoData$IID,
"C:/Users/wenji/OneDrive/Documents/R/win-library/4.0/GRAB/extdata/example",
control = list(showInfo = FALSE, LOCO = FALSE, tolTau = 0.2, tolBeta = 0.1))
a2 = obj.POLMM$LOCOList$`LOCO=F`
head(a2$VarRatioMat)
head(a1$VarRatioMat)
POLMM = read.table(output.file, header = T)
GRAB = read.table(OutputFile, header = T)
head(POLMM)
head(GRAB)
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
library(POLMM)
obj.POLMM = POLMM_Null_Model(factor(Ordinal) ~ Cova1 + Cova2, PhenoData, PhenoData$IID,
"C:/Users/wenji/OneDrive/Documents/R/win-library/4.0/GRAB/extdata/example",
control = list(showInfo = FALSE, LOCO = FALSE, tolTau = 0.2, tolBeta = 0.1))
# bbbInPOLMM=obj.POLMM$LOCOList$`LOCO=F`
#
# bbbInPOLMM$VarRatioMat
# aaaInPOLMM$VarRatioMat
# aaaInGRAB$VarRatioMat
GenoFile = system.file("extdata", "example.bed", package = "GRAB")
PlinkFile = gsub(".bed$", "", GenoFile)
output.file = "C:/Users/wenji/OneDrive/Documents/Github/POLMM.txt"
POLMM.plink(
obj.POLMM,
PlinkFile,
output.file,
"1",
memory.chunk = 4,
SPAcutoff = 2,
minMAF = 1e-04,
maxMissing = 0.15,
impute.method = "fixed",
G.model = "Add"
)
file.remove(output.file)
POLMM.plink(
obj.POLMM,
PlinkFile,
output.file,
"1",
memory.chunk = 4,
SPAcutoff = 2,
minMAF = 1e-04,
maxMissing = 0.15,
impute.method = "fixed",
G.model = "Add"
)
PhenoData = read.table(system.file("extdata", "example.pheno", package = "GRAB"), header = T)
GenoFile = system.file("extdata", "example.bed", package = "GRAB")
obj.GRAB = GRAB.NullModel(factor(Ordinal) ~ Cova1 + Cova2,
data = PhenoData, subjData = PhenoData$IID, method = "POLMM", traitType = "ordinal",
GenoFile = GenoFile,
control = list(showInfo = FALSE, LOCO = FALSE, tolTau = 0.2, tolBeta = 0.1))
IDsToIncludeFile = system.file("extdata", "IDsToInclude.txt", package = "GRAB")
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/POLMMMarkers.txt")
GRAB.Marker(obj.GRAB, GenoFile = GenoFile,
OutputFile = OutputFile,
control = list(IDsToIncludeFile = IDsToIncludeFile))
POLMM = read.table(output.file, header = T)
GRAB = read.table(OutputFile, header = T)
head(POLMM)
head(GRAB)
sqrt(60.0609)
std = 8.481675 / sqrt(70.89233)
std
pnorm(std)
2*pnorm(-1*std)
save(obj.GRAB, "C:/Users/wenji/OneDrive/Documents/Github/objGRAB.RData")
save(obj.GRAB, file = "C:/Users/wenji/OneDrive/Documents/Github/objGRAB.RData")
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
load("C:/Users/wenji/OneDrive/Documents/Github/objGRAB.RData")
IDsToIncludeFile = system.file("extdata", "IDsToInclude.txt", package = "GRAB")
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/POLMMMarkers.txt")
GRAB.Marker(obj.GRAB, GenoFile = GenoFile,
OutputFile = OutputFile,
control = list(IDsToIncludeFile = IDsToIncludeFile))
output.file = "C:/Users/wenji/OneDrive/Documents/Github/POLMM.txt"
POLMM = read.table(output.file, header = T)
GRAB = read.table(OutputFile, header = T)
head(POLMM)
head(GRAB)
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
load("C:/Users/wenji/OneDrive/Documents/Github/objGRAB.RData")
IDsToIncludeFile = system.file("extdata", "IDsToInclude.txt", package = "GRAB")
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/POLMMMarkers.txt")
GRAB.Marker(obj.GRAB, GenoFile = GenoFile,
OutputFile = OutputFile,
control = list(IDsToIncludeFile = IDsToIncludeFile))
# a1 = obj.GRAB$LOCOList$`LOCO=F`
# head(a1$VarRatioMat)
#
# a2 = obj.POLMM$LOCOList$`LOCO=F`
# head(a2$VarRatioMat)
output.file = "C:/Users/wenji/OneDrive/Documents/Github/POLMM.txt"
POLMM = read.table(output.file, header = T)
GRAB = read.table(OutputFile, header = T)
head(POLMM)
head(GRAB)
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
load("C:/Users/wenji/OneDrive/Documents/Github/objGRAB.RData")
IDsToIncludeFile = system.file("extdata", "IDsToInclude.txt", package = "GRAB")
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/POLMMMarkers.txt")
GRAB.Marker(obj.GRAB, GenoFile = GenoFile,
OutputFile = OutputFile,
control = list(IDsToIncludeFile = IDsToIncludeFile))
output.file = "C:/Users/wenji/OneDrive/Documents/Github/POLMM.txt"
POLMM = read.table(output.file, header = T)
GRAB = read.table(OutputFile, header = T)
head(POLMM)
head(GRAB)
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
load("C:/Users/wenji/OneDrive/Documents/Github/objGRAB.RData")
IDsToIncludeFile = system.file("extdata", "IDsToInclude.txt", package = "GRAB")
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/POLMMMarkers.txt")
GRAB.Marker(obj.GRAB, GenoFile = GenoFile,
OutputFile = OutputFile,
control = list(IDsToIncludeFile = IDsToIncludeFile))
# a1 = obj.GRAB$LOCOList$`LOCO=F`
# head(a1$VarRatioMat)
#
# a2 = obj.POLMM$LOCOList$`LOCO=F`
# head(a2$VarRatioMat)
output.file = "C:/Users/wenji/OneDrive/Documents/Github/POLMM.txt"
POLMM = read.table(output.file, header = T)
GRAB = read.table(OutputFile, header = T)
head(POLMM)
head(GRAB)
?POLMM
library(POLMM)
?POLMM
GenoFile = system.file("extdata", "example.bed", package = "GRAB")
IDsToIncludeFile = system.file("extdata", "IDsToInclude.txt", package = "GRAB")
GenoList = GRAB::GRAB.ReadGeno(GenoFile, control=list(IDsToIncludeFile = IDsToIncludeFile))
names(GenoList)
GenoMat = GenoList$GenoMat
dim(GenoMat)
head(GenoMat)
outPOLMM = POLMM(obj.POLMM, GenoMat)
outPOLMM
remove.packages("POLMM", lib="~/R/win-library/4.0")
load("C:/Users/wenji/OneDrive/Documents/Github/objGRAB.RData")
GenoFile = system.file("extdata", "example.bed", package = "GRAB")
IDsToIncludeFile = system.file("extdata", "IDsToInclude.txt", package = "GRAB")
GenoList = GRAB::GRAB.ReadGeno(GenoFile, control=list(IDsToIncludeFile = IDsToIncludeFile))
GenoMat = GenoList$GenoMat
outPOLMM = POLMM(obj.POLMM, GenoMat)
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/POLMMMarkers.txt")
GRAB.Marker(obj.GRAB, GenoFile = GenoFile,
OutputFile = OutputFile,
control = list(IDsToIncludeFile = IDsToIncludeFile))
load("C:/Users/wenji/OneDrive/Documents/Github/objGRAB.RData")
library(POLMM)
library(GRAB)
GenoFile = system.file("extdata", "example.bed", package = "GRAB")
IDsToIncludeFile = system.file("extdata", "IDsToInclude.txt", package = "GRAB")
GenoList = GRAB::GRAB.ReadGeno(GenoFile, control=list(IDsToIncludeFile = IDsToIncludeFile))
GenoMat = GenoList$GenoMat
outPOLMM = POLMM(obj.POLMM, GenoMat)
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/POLMMMarkers.txt")
GRAB.Marker(obj.GRAB, GenoFile = GenoFile,
OutputFile = OutputFile,
control = list(IDsToIncludeFile = IDsToIncludeFile))
OutputFile
file.remove(OutputFile)
GRAB.Marker(obj.GRAB, GenoFile = GenoFile,
OutputFile = OutputFile,
control = list(IDsToIncludeFile = IDsToIncludeFile))
outPOLMM = POLMM(obj.POLMM, GenoMat)
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
# save(obj.GRAB, file = "C:/Users/wenji/OneDrive/Documents/Github/objGRAB.RData")
load("C:/Users/wenji/OneDrive/Documents/Github/objGRAB.RData")
library(POLMM)
library(GRAB)
GenoFile = system.file("extdata", "example.bed", package = "GRAB")
IDsToIncludeFile = system.file("extdata", "IDsToInclude.txt", package = "GRAB")
GenoList = GRAB::GRAB.ReadGeno(GenoFile, control=list(IDsToIncludeFile = IDsToIncludeFile))
GenoMat = GenoList$GenoMat
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/POLMMMarkers.txt")
file.remove(OutputFile)
GRAB.Marker(obj.GRAB, GenoFile = GenoFile,
OutputFile = OutputFile,
control = list(IDsToIncludeFile = IDsToIncludeFile))
outPOLMM = POLMM(obj.POLMM, GenoMat)
remove.packages("POLMM", lib="~/R/win-library/4.0")
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
load("C:/Users/wenji/OneDrive/Documents/Github/objGRAB.RData")
library(POLMM)
library(GRAB)
GenoFile = system.file("extdata", "example.bed", package = "GRAB")
IDsToIncludeFile = system.file("extdata", "IDsToInclude.txt", package = "GRAB")
GenoList = GRAB::GRAB.ReadGeno(GenoFile, control=list(IDsToIncludeFile = IDsToIncludeFile))
GenoMat = GenoList$GenoMat
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/POLMMMarkers.txt")
file.remove(OutputFile)
GRAB.Marker(obj.GRAB, GenoFile = GenoFile,
OutputFile = OutputFile,
control = list(IDsToIncludeFile = IDsToIncludeFile))
outPOLMM = POLMM(obj.POLMM, GenoMat)
remove.packages("GRAB", lib="~/R/win-library/4.0")
remove.packages("POLMM", lib="~/R/win-library/4.0")
library(GRAB)
load("C:/Users/wenji/OneDrive/Documents/Github/objGRAB.RData")
library(POLMM)
library(GRAB)
GenoFile = system.file("extdata", "example.bed", package = "GRAB")
IDsToIncludeFile = system.file("extdata", "IDsToInclude.txt", package = "GRAB")
GenoList = GRAB::GRAB.ReadGeno(GenoFile, control=list(IDsToIncludeFile = IDsToIncludeFile))
GenoMat = GenoList$GenoMat
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/POLMMMarkers.txt")
file.remove(OutputFile)
GRAB.Marker(obj.GRAB, GenoFile = GenoFile,
OutputFile = OutputFile,
control = list(IDsToIncludeFile = IDsToIncludeFile))
outPOLMM = POLMM(obj.POLMM, GenoMat)
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
load("C:/Users/wenji/OneDrive/Documents/Github/objGRAB.RData")
library(POLMM)
library(GRAB)
GenoFile = system.file("extdata", "example.bed", package = "GRAB")
IDsToIncludeFile = system.file("extdata", "IDsToInclude.txt", package = "GRAB")
GenoList = GRAB::GRAB.ReadGeno(GenoFile, control=list(IDsToIncludeFile = IDsToIncludeFile))
GenoMat = GenoList$GenoMat
OutputDir = system.file("results", package = "GRAB")
OutputFile = paste0(OutputDir, "/POLMMMarkers.txt")
file.remove(OutputFile)
GRAB.Marker(obj.GRAB, GenoFile = GenoFile,
OutputFile = OutputFile,
control = list(IDsToIncludeFile = IDsToIncludeFile))
outPOLMM = POLMM(obj.POLMM, GenoMat)
read.table(OutputFile, header = T)
outPOLMM
Rcpp::sourceCpp('C:/Users/wenji/OneDrive/Desktop/test.cpp')
remove.packages("GRAB", lib="~/R/win-library/4.0")
library(GRAB)
?GRAB.POLMM
?GRAB.Region
?GRAB.SimubVec
regionData = read.table("AnnoFile.txt")
setwd("C:/Users/wenji/OneDrive/Documents/Github/GRAB/inst/extdata")
regionData = read.table("AnnoFile.txt")
head(regionData)
regionData = read.table("AnnoFile.txt", header = T)
regionData
setwd("C:/Users/wenji/OneDrive/Documents/Github/GRAB/inst/extdata")
regionData = read.table("AnnoFile.txt", header = T)
regionData
regionData$ANNO2 = regionData$
# POLMM.plink(
#   obj.POLMM,
#   PlinkFile,
#   output.file,
#   "1",
#   memory.chunk = 4,
#   SPAcutoff = 2,
#   minMAF = 1e-04,
#   maxMissing = 0.15,
#   impute.method = "fixed",
#   G.model = "Add"
# )
PhenoData = read.table(system.file("extdata", "example.pheno", package = "GRAB"), header = T)
regionData$ANNO2 = regionData$ANNO
head(regionData)
colnames(regionData)[c(3,4)] = c("ANNO1", "ANNO2")
regionData
bimData = read.table("nSNPs-10000-nsubj-1000-ext.bim")
bimData = read.table("nSNPs-10000-nsubj-1000-ext.bim", header = T)
head(bimData)
bimData = read.table("nSNPs-10000-nsubj-1000-ext.bim")
head(bimData,20)
regionData$SNP = bimData$V2[1:20]
regionData$ANNO1 = runif(20)
regionData$ANNO2 = runif(20)
regionData
colnames(regionData)[1] = "REGION"
write.table(regionData, "example.RegionFile.txt", row.names = F, col.names = T, quote = F)
colnames(regionData)[2] = "MARKER"
write.table(regionData, "example.RegionFile.txt", row.names = F, col.names = T, quote = F)
?GRAB.Region
?GRAB.Marker
?GRAB.POLMM
remove.packages("GRAB", lib="~/R/win-library/4.0")
