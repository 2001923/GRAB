library(GRAB)
setwd(system.file("wSPAg", package = "GRAB"))
load("Example.RData")
qcResult1 = QCforBatchEffect(GenoFile = c("simuBGEN1.bgen")
,GenoFileIndex = c("simuBGEN1.bgen.bgi",
"simuBGEN1.sample")
,control=list(AlleleOrder = "ref-first", AllMarkers=T)
,PhenoData=PhenoData
,RefAfFile = "RefMAFs.txt"
,RefPrevalence = RefPrevalence
,SNPnum=1e4
)
setwd(system.file("wSPAg", package = "GRAB"))
load("Example.RData")
qcResult1 = QCforBatchEffect(GenoFile = c("simuBGEN1.bgen")
,GenoFileIndex = c("simuBGEN1.bgen.bgi",
"simuBGEN1.sample")
,control=list(AlleleOrder = "ref-first", AllMarkers=T)
,PhenoData=PhenoData
,RefAfFile = "RefMAFs.txt"
,RefPrevalence = RefPrevalence
,SNPnum=1e4
)
ref =data.table::fread(RefMAFs.txt)
ref =data.table::fread("RefMAFs.txt")
head(ref)
dim(ref)
ref =data.table::fread("RefMAFs.txt")
head(ref)
library(GRAB)
setwd(system.file("wSPAg", package = "GRAB"))
load("Example.RData")
ref = data.table::fread("RefMAFs.txt")
head(ref)
qcResult1 = QCforBatchEffect(GenoFile = c("simuBGEN1.bgen")
,GenoFileIndex = c("simuBGEN1.bgen.bgi",
"simuBGEN1.sample")
,control=list(AlleleOrder = "ref-first", AllMarkers=T)
,PhenoData=PhenoData
,RefAfFile = "RefMAFs.txt"
,RefPrevalence = RefPrevalence
,SNPnum=1e4
)
qcResult2 = QCforBatchEffect(GenoFile = c("simuBGEN2.bgen")
,GenoFileIndex = c("simuBGEN2.bgen.bgi",
"simuBGEN2.sample")
,control=list(AlleleOrder = "ref-first", AllMarkers=T)
,PhenoData=PhenoData
,RefAfFile = "RefMAFs.txt"
,RefPrevalence = RefPrevalence
,SNPnum=1e4
)
allQC = mergeQCresults(qcResult1,qcResult2)
Residual = getResid.wCox(formula = Surv(time, Indicator) ~ X1 + X2
, PhenoData = PhenoData
, RefPrevalence = RefPrevalence)
